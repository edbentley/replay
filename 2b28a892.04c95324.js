(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{105:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),i=r(166),o=r(183),u=r(60);t.default=function(){return a.a.createElement(i.a,{part:23,MDXContent:u.default,Game:o.a,gameProps:o.b,isEnd:!0})}},160:function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return i}));var n=r(161),a={text:function(e){return{type:"text",props:Object(n.b)({testId:e.testId,font:e.font,text:e.text,color:e.color,gradient:e.gradient,strokeColor:e.strokeColor,strokeThickness:e.strokeThickness},e)}},circle:function(e){return{type:"circle",props:Object(n.b)({testId:e.testId,radius:e.radius,color:e.color},e)}},rectangle:function(e){return{type:"rectangle",props:Object(n.b)({testId:e.testId,width:e.width,height:e.height,color:e.color,gradient:e.gradient},e)}},rectangleArray:function(e){return{type:"rectangleArray",mask:e.mask||null,props:e.props.map((function(e){return Object(n.b)({testId:e.testId,width:e.width,height:e.height,color:e.color},e)}))}},line:function(e){var t;return{type:"line",props:Object(n.b)({testId:e.testId,color:e.color,fillColor:e.fillColor,thickness:null!==(t=e.thickness)&&void 0!==t?t:1,lineCap:e.lineCap||"butt",path:e.path,fillGradient:e.fillGradient},e)}},image:function(e){return{type:"image",props:Object(n.b)({testId:e.testId,fileName:e.fileName,width:e.width,height:e.height},e)}},imageArray:function(e){return{type:"imageArray",fileName:e.fileName,mask:e.mask||null,props:e.props.map((function(e){return Object(n.b)({testId:e.testId,width:e.width,height:e.height},e)}))}},spriteSheet:function(e){return{type:"spriteSheet",props:Object(n.b)({testId:e.testId,fileName:e.fileName,columns:e.columns,rows:e.rows,index:e.index,width:e.width,height:e.height},e)}}};r(162);function i(e){return function(t){return{type:"custom",spriteObj:e,props:t}}}},161:function(e,t,r){"use strict";function n(e){var t,r,n;return{x:e.x||0,y:e.y||0,rotation:e.rotation||0,opacity:Math.min(1,Math.max(0,null!==(t=e.opacity)&&void 0!==t?t:1)),scaleX:null!==(r=e.scaleX)&&void 0!==r?r:1,scaleY:null!==(n=e.scaleY)&&void 0!==n?n:1,anchorX:e.anchorX||0,anchorY:e.anchorY||0,mask:e.mask||null,show:e.show||!0}}function a(e,t){var r,n,a,i,o=e;return o.x=t.x||0,o.y=t.y||0,o.rotation=t.rotation||0,o.opacity=Math.min(1,Math.max(0,null!==(r=t.opacity)&&void 0!==r?r:1)),o.scaleX=null!==(n=t.scaleX)&&void 0!==n?n:1,o.scaleY=null!==(a=t.scaleY)&&void 0!==a?a:1,o.anchorX=t.anchorX||0,o.anchorY=t.anchorY||0,o.mask=t.mask||null,o.show=null===(i=t.show)||void 0===i||i,o}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}))},162:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(161);function a(e,t){var r;switch(e.type){case"rectangleArray":var a=t;return Object(n.b)({testId:a.testId,width:a.width||10,height:a.height||10,color:a.color||"black"},a);case"textArray":var i=t;return Object(n.b)({testId:i.testId,font:i.font,text:i.text||"",color:i.color||"black",gradient:i.gradient,strokeColor:i.strokeColor,strokeThickness:i.strokeThickness},i);case"circleArray":var o=t;return Object(n.b)({testId:o.testId,radius:o.radius||10,color:o.color||"black",gradient:o.gradient},o);case"lineArray":var u=t;return Object(n.b)({testId:u.testId,color:u.color,fillColor:u.fillColor,thickness:null!==(r=u.thickness)&&void 0!==r?r:1,lineCap:u.lineCap||"butt",path:u.path||[],gradient:u.gradient,fillGradient:u.fillGradient},u);case"imageArray":var s=t;return Object(n.b)({testId:s.testId,width:s.width||10,height:s.height||10},s)}}},166:function(e,t,r){"use strict";r.d(t,"a",(function(){return Ge}));var n=r(0),a=r.n(n),i=r(171),o=r(170),u=r(177),s=r(3),l=r(173),c=r(172),d=r(167),p=r(168),f=r(174),v=r.n(f),m=r(56),h=r.n(m);function g(e){var t=e.codesTs,r=e.codesJs;return a.a.createElement(d.a,{defaultValue:"js",groupId:"code",values:[{label:"JavaScript",value:"js"},{label:"TypeScript",value:"ts"}]},a.a.createElement(p.a,{value:"js"},a.a.createElement(y,{lang:"js",codes:r})),a.a.createElement(p.a,{value:"ts"},a.a.createElement(y,{lang:"ts",codes:t})))}function y(e){var t=e.lang,r=e.codes,i=r.map((function(e){return e.file})),o=Object(n.useState)(i[0]),u=o[0],s=o[1],l=r.find((function(e){return e.file===u}));return a.a.createElement("div",{style:{marginTop:-12}},a.a.createElement("div",{style:{position:"sticky",top:0,backgroundColor:"white",zIndex:1}},i.map((function(e){return a.a.createElement("button",{className:h.a.fileButton+(u===e?" "+h.a.fileButtonSelected:""),key:e,onClick:function(){return s(e)}},e)}))),a.a.createElement(x,{key:l.file,lang:t,code:l.code,highlight:l.highlight}))}function x(e){var t=e.lang,r=e.code,n=e.highlight,i=r.replace("/img/bird.png","bird.png").replace("/audio/boop.wav","boop.wav");return a.a.createElement(l.a,Object(s.a)({},l.b,{theme:c.a,code:i,language:t}),(function(e){var t=e.className,r=e.style,i=e.tokens,o=e.getLineProps,u=e.getTokenProps;return a.a.createElement("div",{className:h.a.codeBlockContent},a.a.createElement("div",{tabIndex:"0",className:v()(t,h.a.codeBlock)},a.a.createElement("div",{className:h.a.codeBlockLines,style:r},i.map((function(e,t){1===e.length&&""===e[0].content&&(e[0].content="\n");var r=o({line:e,key:t}),i=null==n?void 0:n.flatMap((function(e){if("number"==typeof e)return e;var t=e.split("-").map(Number),r=t[0],n=t[1];return Array.from({length:n-r+1}).map((function(e,t){return t+r}))}));return null!=i&&i.includes(t+1)&&(r.className+=" docusaurus-highlight-code-line"),a.a.createElement("div",r,a.a.createElement("span",{style:{display:"inline-block",width:30,textAlign:"right",marginRight:16,opacity:.5,userSelect:"none"}},t+1),e.map((function(e,t){return a.a.createElement("span",u({token:e,key:t}))})))})))))}))}var b=r(163),A=r.n(b),_=r(164),w=r(165);function E(e,t,r){return S.apply(this,arguments)}function S(){return(S=Object(_.a)(A.a.mark((function e(t,r,n){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([].concat(T(t,r.audioFileNames||[],n.audioElements,n.loadAudioFile),T(t,r.imageFileNames||[],n.imageElements,(function(e){return n.loadImageFile(e,!1)})),T(t,r.imageFileNamesScaleNearestPixel||[],n.imageElements,(function(e){return n.loadImageFile(e,!0)}))));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e,t,r,n){return t.map((function(t){if(r[t]){r[t].globalSpriteIds.push(e);var a=r[t].data;return"then"in a?a:Promise.resolve()}var i=n(t).then((function(e){r[t].data=e}));return r[t]={globalSpriteIds:[e],data:i},i}))}function R(e,t){P(e,t.audioElements,t.cleanupAudioFile),P(e,t.imageElements,t.cleanupImageFile)}function P(e,t,r){for(var n in t){var a=t[n].globalSpriteIds,i=a.indexOf(e);-1!==i&&(1===a.length?(r(n),delete t[n]):t[n].globalSpriteIds.splice(i,1))}}var k=r(161),I=r(162);var F={identityMatrix:[1,0,0,1,0,0],getNewIdentity3fv:function(){return new Float32Array([1,0,0,0,1,0,0,0,1])},getScaleMatrix:function(e,t){return[e,0,0,t,0,0]},getTranslateMatrix:function(e,t){return[1,0,0,1,e,t]},multiply:function(e,t){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],u=e[5],s=t[0],l=t[1],c=t[2],d=t[3],p=t[4],f=t[5];return[r*s+a*l,n*s+i*l,r*c+a*d,n*c+i*d,r*p+a*f+o,n*p+i*f+u]},transformMut:function(e,t,r,n,a,i,o,u,s,l,c){var d=Math.cos(i),p=Math.sin(i),f=e[0],v=e[1],m=e[2],h=e[3],g=e[4],y=e[5],x=s*d*n,b=s*p*n,A=l*-p*a,_=l*d*a,w=d*n*o-p*a*u+t,E=p*n*o+d*a*u+r;c[0]=f*x+m*b,c[1]=v*x+h*b,c[2]=f*A+m*_,c[3]=v*A+h*_,c[4]=f*w+m*E+g,c[5]=v*w+h*E+y},toUniform3fvMut:function(e,t){t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1},scaleToUniform3fvMut:function(e,t,r,n){var a=e[0],i=e[1],o=e[2],u=e[3],s=e[4],l=e[5];n[0]=a*t,n[1]=i*t,n[2]=0,n[3]=o*r,n[4]=u*r,n[5]=0,n[6]=s,n[7]=l,n[8]=1},multiplyPooled:function(e,t){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],u=e[5],s=t[0],l=t[1],c=t[2],d=t[3],p=t[4],f=t[5];return L[0]=r*s+a*l,L[1]=n*s+i*l,L[2]=r*c+a*d,L[3]=n*c+i*d,L[4]=r*p+a*f+o,L[5]=n*p+i*f+u,L},getTranslateMatrixPooled:function(e,t){return O[4]=e,O[5]=t,O},getScaleMatrixPooled:function(e,t){return M[0]=e,M[3]=t,M},getRotateMatrixPooled:function(e){var t=Math.sin(e),r=Math.cos(e);return C[0]=r,C[1]=t,C[2]=-t,C[3]=r,C},getScalePooled:function(e){return U.scaleX=Math.hypot(e[0],e[2]),U.scaleY=Math.hypot(e[1],e[3]),U},invertPooled:function(e){var t=e[0],r=e[1],n=e[2],a=e[3],i=e[4],o=e[5],u=t*a-r*n;if(!u)return null;return u=1/u,N[0]=a*u,N[1]=-r*u,N[2]=-n*u,N[3]=t*u,N[4]=(n*o-a*i)*u,N[5]=(r*i-t*o)*u,N}};var L=[0,0,0,0,0,0];var O=[1,0,0,1,0,0];var M=[0,0,0,0,0,0];var C=[0,0,0,0,0,0];var U={scaleX:0,scaleY:0};var N=[0,0,0,0,0,0];function B(e,t,r,n,a){void 0===n&&(n=1),void 0===a&&(a=1),F.transformMut(e,r.x,r.y,r.scaleX,r.scaleY,-r.rotation*z,-r.anchorX,-r.anchorY,n,a,t)}var D=[0,0,0,0,0,0];function j(e,t,r,n){return void 0===r&&(r=1),void 0===n&&(n=1),B(e,D,t,r,n),D}var z=Math.PI/180;function Y(e,t,r,n,a,i,o,u,s,l,c,d,p,f){var v=e.baseProps;Object(k.b)(v,t);var m=n.addToStack(v),h=e.getSprites(t,m,o,u,s,f),g=e.prevChildIdsSet,y=e.prevChildIds,x=0;d.startRenderSprite(v,m,null),X(h,e,r,n,a,i,u,s,l,c,d,p,f,(function(e){y[x]=e,x++,g.delete(e)})),d.endRenderSprite(n.removeFromStack()),x<y.length&&(y.length=x);for(var b,A=Object(w.a)(g);!(b=A()).done;){var _,E=b.value,S=e.childContainers[E];G(((_={})[E]=S,_),l,r),delete e.childContainers[E]}e.prevChildIdsSet.clear();for(var T,R=Object(w.a)(y);!(T=R()).done;){var P=T.value;e.prevChildIdsSet.add(P)}if(e.prevChildIdsSet.size<y.length){var I=y.find((function(e,t){return y.indexOf(e)!==t}));throw Error("Duplicate Sprite id "+I)}}function G(e,t,r){for(var n in e){var a=e[n];"custom"===a.type&&function(){var e=t+"--"+n;G(a.childContainers,e,r),a.loadFilesPromise&&a.loadFilesPromise.then((function(){R(e,r.assetUtils)}))}(),a.cleanup()}}function X(e,t,r,n,a,i,o,u,s,l,c,d,p,f){for(var v=0;v<e.length;v++){var m=e[v];if(m)if("context"===m.type)X(m.sprites,t,r,n,a,i,o,u,s,l,c,d,[].concat(p,[m]),f);else if("native"===m.type)!function(){f(m.props.id);var e=l.nativeSpriteMap,r=l.nativeSpriteUtils,a=e[m.name];if(!a)throw Error('Cannot find Native Sprite "'+m.name+'"');var i=t.childContainers[m.props.id];if(!i||"native"!==i.type){var o={type:"native",props:m.props,state:a.create({props:m.props,parentGlobalId:s,getState:function(){return o.state},utils:r}),updateSprite:function(){c.startNativeSprite(),a.loop({props:o.props,state:o.state,parentGlobalId:s,utils:r,spriteToGameCoords:function(e,t,r){var a=F.multiplyPooled(n.getTopStack().transformationGameCoords,F.getTranslateMatrixPooled(e,t));r.x=a[4],r.y=a[5]}}),c.endNativeSprite()},cleanup:function(){a.cleanup({state:this.state,parentGlobalId:s})}};t.childContainers[m.props.id]=o,i=o}i.props=m.props,i.updateSprite()}();else if("pure"===m.type){f(m.props.id);var h=t.childContainers[m.props.id];h&&"pure"===h.type||(h=q(m),t.childContainers[m.props.id]=h),Q(h,m.props,n,r.size,l.nativeSpriteUtils.didResize,o,c)}else if("custom"===m.type){f(m.props.id);var g=!1,y=t.childContainers[m.props.id],x=s+"--"+m.props.id;y&&"custom"===y.type||(g=!0,y=W(m,r,a,i,n,t.prevTime,x,p),t.childContainers[m.props.id]=y),Y(y,m.props,r,n,a,i,g,o,u,x,l,c,d,p)}else if("mutable"===m.type){if(!m.props.id)throw Error("Mutable sprite must have id prop in non-Mutable Sprites");f(m.props.id);var b=t.childContainers[m.props.id],A=s+"--"+m.props.id,_=!1;if(!b||"mutable"!==b.type){if(_=!0,"mutable"!==(b=K(m,r,n,a,i,t.prevTime,A,[],c,d,l)).type)throw Error("Can only render mutable Sprite");t.childContainers[m.props.id]=b}for(var w in m.props)b.props[w]=m.props[w];var E=n.addToStack(b.props);c.startRenderSprite(b.props,E,b.maskState),b.updateSprites(_),c.endRenderSprite(n.removeFromStack())}else c.renderTexture(n.getTopStack(),m,c.getInitTextureState(m),null)}}var V=1/60*1e3;function W(e,t,r,n,a,i,o,u){var s,l,c=e.spriteObj,d=e.props,p=[],f=function(e){p.push(e)},v=null,m=null;c.init&&(s=c.init({props:d,getState:function(){if(!v)throw Error("Cannot call getState synchronously in init");return v.state},device:t,getInputs:function(){return r(a.getStack((null==v?void 0:v.stackIndex)||0).transformationGameCoords,(null==v?void 0:v.inputs)||n())},updateState:f,getContext:function(e){var t=u.find((function(t){return t.context===e}));if(!t)throw Error("No context setup");return t.value},preloadFiles:(l=Object(_.a)(A.a.mark((function e(r){var n;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=E(o,r,t.assetUtils),v?v.loadFilesPromise=n:m=n,e.next=4,n;case 4:case"end":return e.stop()}}),e)}))),function(e){return l.apply(this,arguments)})}));var h=function(){for(var e=0;e<p.length;){var t=p[e];v.state=t(v.state),e++}p.length=0},g=function(){return v.state};return v={type:"custom",state:s,inputs:n(),baseProps:Object(k.a)(d),childContainers:{},prevChildIds:[],prevChildIdsSet:new Set,prevTime:i,currentLag:0,loadFilesPromise:m,stackIndex:null,getSprites:function(e,n,i,o,u,s){var l=this;h(),null===this.stackIndex&&(this.stackIndex=a.getStackIndex());var d=function(e){var t=s.find((function(t){return t.context===e}));if(!t)throw Error("No context setup");return t.value};!i&&c.loop&&(this.state=c.loop({props:e,state:this.state,device:t,getInputs:function(){return r(n.transformationGameCoords,l.inputs)},updateState:f,getState:g,getContext:d})),h();var p=c[o];p||(p="renderPXL"===o&&c.renderXL?c.renderXL:c.render);var v=p({props:e,state:this.state,device:t,getInputs:function(){return r(n.transformationGameCoords,l.inputs)},updateState:f,getState:g,getContext:d,extrapolateFactor:u});return h(),v},cleanup:function(){var e;null===(e=c.cleanup)||void 0===e||e.call(c,{state:this.state,device:t})}}}function H(e,t){var r,n=e.deviceHeight>e.deviceWidth,a=!1;return"portrait"in t?(r=n?t.portrait:t.landscape,a=!0):r=t,r.minHeightXL&&e.deviceHeight>=r.minHeightXL||r.minWidthXL&&e.deviceWidth>=r.minWidthXL?a&&n?"renderPXL":"renderXL":a&&n?"renderP":"render"}function J(e,t,r,n){switch(e.type){case"mutable":e.updateSelf();var a=r.addToStack(e.props);t.startRenderSprite(e.props,a,e.maskState),e.updateSprites(n),t.endRenderSprite(r.removeFromStack());break;case"mutableArray":for(var i in e.updateSprites(),e.containersArray){var o=e.containersArray[i],u=r.addToStack(o.props);t.startRenderSprite(o.props,u,o.maskState),o.updateSprites(n),t.endRenderSprite(r.removeFromStack())}break;case"mutTexture":e.updateTexture(),t.renderTexture(r.getTopStack(),e.texture,e.textureState,e.maskState);break;case"mutOnChange":n=n||e.updateOnChange();for(var s,l=Object(w.a)(e.containers);!(s=l()).done;){J(s.value,t,r,n)}break;case"mutArrayTexture":e.updateTextureArray(),t.renderTexture(r.getTopStack(),e.texture,e.textureState,e.maskState);break;case"mutRun":e.updateRun();break;case"mutContext":for(var c,d=Object(w.a)(e.containers);!(c=d()).done;){J(c.value,t,r,n)}break;case"native":e.updateSprite();break;default:!function(e){throw new Error("Replay unreachable error")}()}}function K(e,t,r,n,a,i,o,u,s,l,c){var d,p,f;if(null===e)return null;switch(e.type){case"text":case"circle":case"rectangle":case"image":case"line":case"spriteSheet":var v=e.props,m=e.update;return null==m||m(v),{type:"mutTexture",texture:e,textureState:s.getInitTextureState(e),maskState:s.getInitMaskState(e.props.mask),updateTexture:function(){null==m||m(this.texture.props)},cleanup:function(){return null}};case"rectangleArray":case"textArray":case"circleArray":case"lineArray":case"imageArray":var h=e.array(),g=e.update;return e.props=Array.from({length:h.length}).map((function(t,r){var n=Object(I.a)(e,e.newProps(h[r],r));return null==g||g(n,h[r],r),n})),{type:"mutArrayTexture",texture:e,array:e.array,textureState:s.getInitTextureState(e),maskState:s.getInitMaskState(e.mask),cleanup:function(){return null},pooledProps:[],updateTextureArray:function(){var t=this.array(),r=t.length,n=this.texture.props.length,a=r-n;if(a>0)for(var i=0;i<a;i++)if(this.pooledProps.length>0)this.texture.props.push(this.pooledProps.pop());else{var o=Object(I.a)(e,e.newProps(t[n+i],n+i));this.texture.props.push(o)}else if(a<0)for(var u=-a;u>0;)u--,this.pooledProps.push(this.texture.props.pop());for(var s=0;s<this.texture.props.length;s++){var c=this.texture.props[s];null==g||g(c,t[s],s),l&&e.testId&&(c.testId=e.testId(t[s],s))}}};case"onChange":var y=e.value();return{type:"mutOnChange",value:y,containers:e.sprites().map((function(e,d){return K(e,t,r,n,a,i,o+"--"+y+"-"+d,u,s,l,c)})).filter($),updateOnChange:function(){var d=e.value();return this.value!==d&&(this.value=d,this.cleanup(),this.containers=e.sprites().map((function(e,p){return K(e,t,r,n,a,i,o+"--"+d+"-"+p,u,s,l,c)})).filter($),!0)},cleanup:function(){for(var e,t=Object(w.a)(this.containers);!(e=t()).done;){e.value.cleanup()}}};case"run":return{type:"mutRun",updateRun:function(){e.fn()},cleanup:function(){return null}};case"conditional":var x=e.condition();return{type:"mutOnChange",value:x,containers:(x?e.trueSprites():e.falseSprites()).map((function(e,d){return K(e,t,r,n,a,i,o+"--"+x+"-"+d,u,s,l,c)})).filter($),updateOnChange:function(){var d=e.condition();return!this.value&&d?(this.value=!0,this.cleanup(),this.containers=e.trueSprites().map((function(e,d){return K(e,t,r,n,a,i,o+"--true-"+d,u,s,l,c)})).filter($),!0):!(!this.value||d)&&(this.value=!1,this.cleanup(),this.containers=e.falseSprites().map((function(e,d){return K(e,t,r,n,a,i,o+"--false-"+d,u,s,l,c)})).filter($),!0)},cleanup:function(){for(var e,t=Object(w.a)(this.containers);!(e=t()).done;){e.value.cleanup()}}};case"mutContext":var b=[].concat(u,[e]);return{type:"mutContext",containers:e.sprites.map((function(e,u){return K(e,t,r,n,a,i,o+"--"+u,b,s,l,c)})).filter($),cleanup:function(){for(var e,t=Object(w.a)(this.containers);!(e=t()).done;){e.value.cleanup()}}};case"native":var S=c.nativeSpriteMap,T=c.nativeSpriteUtils,P=S[e.name];if(!P)throw Error('Cannot find Native Sprite "'+e.name+'"');var L=P.create({props:e.props,parentGlobalId:o,getState:function(){return M.state},utils:T}),O={props:e.props,state:L,parentGlobalId:o,utils:T,spriteToGameCoords:function(e,t,n){var a=F.multiplyPooled(r.getTopStack().transformationGameCoords,F.getTranslateMatrixPooled(e,t));n.x=a[4],n.y=a[5]}},M={type:"native",props:e.props,state:L,updateSprite:function(){var t;s.startNativeSprite(),null===(t=e.update)||void 0===t||t.call(e,this.props),P.loop(O),s.endNativeSprite()},cleanup:function(){P.cleanup({state:M.state,parentGlobalId:o})}};return M;case"mutableArray":var C=e.spriteObj,U=e.update,N=function(t,r){var n,a,i=e.props(t,r);return Object(k.b)(i,i),null===(n=e.update)||void 0===n||n.call(e,i,t,r),null===(a=e.updateAll)||void 0===a||a.call(e,i),{type:"mutable",spriteObj:C,props:i}},B=[];return{type:"mutableArray",props:e.props,update:e.update,filter:e.filter,array:e.array,key:e.key,prevIdsA:B,prevIdsB:B,isOnSamePrevIdRef:!0,onPrevIdA:!0,containersArray:e.array().map((function(t,r){return void 0===e.filter||e.filter(t,r)?t:null})).reduce((function(d,p,f){if(null===p)return d;var v=e.key(p,f);return d[v]=K(N(p,f),t,r,n,a,i,o+"--"+v,u,s,l,c),d}),{}),updateSprites:function(){for(var d,p,f=this.array(),v=this.onPrevIdA?this.prevIdsA:this.prevIdsB,m=this.onPrevIdA?this.prevIdsB:this.prevIdsA,h=0,g=0,y=0;y<f.length;y++){var x=f[y];if(!1!==(null===(d=this.filter)||void 0===d?void 0:d.call(this,x,y))){var b=e.key(x,y);v[h]=b,h++;var A=this.containersArray[b];A||(g++,A=K(N(x,y),t,r,n,a,i,o+"--"+b,u,s,l,c),this.containersArray[b]=A),null===(p=e.updateAll)||void 0===p||p.call(e,A.props),null==U||U(A.props,f[y],y)}}h<v.length&&(v.length=h);var _=v.length,E=m.length+g;if(_>E){var S=v.find((function(e,t){return v.indexOf(e)!==t}));throw Error("Duplicate key "+S)}if(_<E){for(var T,R=new Set(m),P=Object(w.a)(v);!(T=P()).done;){var k=T.value;R.delete(k)}for(var I,F=Object(w.a)(R);!(I=F()).done;){var L=I.value;this.containersArray[L].cleanup(),delete this.containersArray[L]}}this.onPrevIdA=!this.onPrevIdA,this.isOnSamePrevIdRef&&(this.isOnSamePrevIdRef=!1,this.prevIdsB=[].concat(this.prevIdsB))},cleanup:function(){for(var e in this.containersArray)this.containersArray[e].cleanup()}};case"mutable":{var D=e.spriteObj,j=null;function z(e){var t=u.find((function(t){return t.context===e}));if(!t)throw Error("No context setup");return t.value()}var Y=e.props;Object(k.b)(Y,Y),null===(d=e.update)||void 0===d||d.call(e,Y);var G=null,X=null===(p=D.init)||void 0===p?void 0:p.call(D,{props:Y,device:t,getState:function(){if(!G)throw Error("Cannot call getState synchronously in init");return G.state},getInputs:function(){return n(r.getStack((null==G?void 0:G.stackIndex)||0).transformationGameCoords,(null==G?void 0:G.inputs)||a())},getContext:z,preloadFiles:(f=Object(_.a)(A.a.mark((function e(r){var n;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=E(o,r,t.assetUtils),G?G.loadFilesPromise=n:j=n,e.next=4,n;case 4:case"end":return e.stop()}}),e)}))),function(e){return f.apply(this,arguments)})}),V={props:Y,state:X,device:t,getInputs:function(){return n(r.getStack((null==G?void 0:G.stackIndex)||0).transformationGameCoords,(null==G?void 0:G.inputs)||a())},getContext:z};return G={type:"mutable",props:Y,state:X,inputs:a(),stackIndex:null,maskState:s.getInitMaskState(e.props.mask),childContainers:D.render({props:Y,state:X,device:t,getInputs:function(){return n(r.getStack((null==G?void 0:G.stackIndex)||0).transformationGameCoords,(null==G?void 0:G.inputs)||a())},getContext:z}).map((function(e,d){return K(e,t,r,n,a,i,o+"--"+d,u,s,l,c)})).filter($),updateSelf:function(){var t;null===(t=e.update)||void 0===t||t.call(e,Y)},updateSprites:function(e){var t;null===this.stackIndex&&(this.stackIndex=r.getStackIndex()),e||null===(t=D.loop)||void 0===t||t.call(D,V);for(var n,a=Object(w.a)(this.childContainers);!(n=a()).done;){J(n.value,s,r,e)}},cleanup:function(){for(var e,r,n=Object(w.a)(this.childContainers);!(r=n()).done;){r.value.cleanup()}null===(e=D.cleanup)||void 0===e||e.call(D,{state:this.state,device:t}),this.loadFilesPromise&&this.loadFilesPromise.then((function(){R(o,t.assetUtils)}))},loadFilesPromise:j}}}}function q(e){var t=e.spriteObj;return{type:"pure",childContainers:{},prevChildIds:[],prevChildIdsSet:new Set,baseProps:Object(k.a)(e.props),getSprites:function(e,r,n,a){if(this.prevProps&&this.cache&&!t.shouldRerender(this.prevProps,e)&&!n)return this.prevProps=e,this.cache;var i=t[a];return i||(i="renderPXL"===a&&t.renderXL?t.renderXL:t.render),this.prevProps=e,{type:"pureSprites",sprites:i({props:e,size:r})}},cleanup:function(){return null}}}function Q(e,t,r,n,a,i,o){var u=e.baseProps;Object(k.b)(u,t);var s=e.getSprites(t,n,a,i);return"cache"===s.type?(Z(s,o,r),s):function(e,t,r,n,a,i,o){var u=e.baseProps,s=e.prevChildIdsSet,l=e.prevChildIds,c=0;o.startRenderSprite(u,r.addToStack(u),null);for(var d=new Array(t.length),p=0,f=0;f<t.length;f++){var v=t[f];if(v)if("pure"===v.type){l[c]=v.props.id,c++,s.delete(v.props.id);var m=e.childContainers[v.props.id];m&&"pure"===m.type||(m=q(v),e.childContainers[v.props.id]=m),d[p]=Q(m,v.props,r,n,a,i,o),p++}else o.renderTexture(r.getTopStack(),v,o.getInitTextureState(v),null),d[p]=v,p++}p<d.length&&(d.length=p);o.endRenderSprite(r.removeFromStack());for(var h,g=Object(w.a)(s);!(h=g()).done;){var y=h.value;delete e.childContainers[y]}var x={type:"cache",baseProps:u,items:d};e.cache=x,c<l.length&&(l.length=c);if(e.prevChildIdsSet=new Set(l),e.prevChildIdsSet.size<l.length){var b=l.find((function(e,t){return l.indexOf(e)!==t}));throw Error("Duplicate Sprite id "+b)}return x}(e,s.sprites,r,n,a,i,o)}function Z(e,t,r){var n=r.addToStack(e.baseProps);t.startRenderSprite(e.baseProps,n,null);for(var a=0;a<e.items.length;a++){var i=e.items[a];"cache"===i.type?Z(i,t,r):t.renderTexture(n,i,t.getInitTextureState(i),null)}t.endRenderSprite(r.removeFromStack())}function $(e){return null!=e}var ee={keysDown:{},keysJustPressed:{},pointer:{pressed:!1,numberPressed:0,justPressed:!1,justReleased:!1,x:0,y:0}},te=[];var re=[1,0,0,1,0,0];function ne(e,t){t.keysDown=ee.keysDown,t.keysJustPressed=ee.keysJustPressed,t.pointer.pressed=ee.pointer.pressed,t.pointer.numberPressed=ee.pointer.numberPressed,t.pointer.justPressed=ee.pointer.justPressed,t.pointer.justReleased=ee.pointer.justReleased;var r=F.invertPooled(e);if(!r)return t;re[4]=ee.pointer.x,re[5]=ee.pointer.y;var n=F.multiplyPooled(r,re);return t.pointer.x=n[4],t.pointer.y=n[5],t}function ae(){return{keysDown:{},keysJustPressed:{},pointer:{pressed:!1,numberPressed:0,justPressed:!1,justReleased:!1,x:0,y:0}}}function ie(e){["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"," "].includes(e.key)&&!(e.target instanceof HTMLTextAreaElement||e.target instanceof HTMLInputElement)&&e.preventDefault(),ee.keysDown[e.key]=!0,ee.keysJustPressed[e.key]=!0}function oe(e){ee.keysDown[e.key]=void 0}function ue(e,t,r){te.includes(r)||(te=[].concat(te,[r])),ee.pointer.pressed=!0,ee.pointer.numberPressed=te.length,ee.pointer.justPressed=!0,ee.pointer.x=e,ee.pointer.y=t}function se(e,t){ee.pointer.x=e,ee.pointer.y=t}function le(e,t,r){0===(te=te.filter((function(e){return e!==r}))).length&&(ee.pointer.justPressed=!1,ee.pointer.pressed=!1),ee.pointer.numberPressed=te.length,ee.pointer.justReleased=!0,ee.pointer.x=e,ee.pointer.y=t}function ce(e){te=te.filter((function(t){return t!==e})),ee.pointer.numberPressed=te.length,0===te.length&&(ee.pointer.justPressed=!1,ee.pointer.pressed=!1)}function de(){for(var e in ee.keysJustPressed)ee.keysJustPressed[e]=void 0;ee.pointer.justPressed=!1,ee.pointer.justReleased=!1}function pe(e,t,r,n){var a;"portrait"in n?a=t>e?n.portrait:n.landscape:a=n;var i=a,o=i.width,u=i.height,s=i.maxWidthMargin,l=void 0===s?0:s,c=i.maxHeightMargin;if("game-coords"===r||0===e||0===t)return{width:o,height:u,widthMargin:0,heightMargin:0,fullWidth:o,fullHeight:u,deviceWidth:o,deviceHeight:u};var d=o/u;if(d>e/t){var p=e,f=p/d,v=f/u*(void 0===c?0:c),m=Math.min(t,f+2*v),h=(m-f)/2*(u/f);return{width:o,height:u,widthMargin:0,heightMargin:h,fullWidth:o,fullHeight:u+2*h,deviceWidth:p,deviceHeight:m}}var g=t,y=g*d,x=y/o*l,b=Math.min(e,y+2*x),A=(b-y)/2*(o/y);return{width:o,height:u,widthMargin:A,heightMargin:0,fullWidth:o+2*A,fullHeight:u,deviceWidth:b,deviceHeight:g}}function fe(){var e={};return{start:function(t,r){var n=window.setTimeout((function(){delete e[a],t()}),r),a=String(n);return e[a]={timeoutId:n,callback:t,timeStartedMs:Date.now(),timeRemainingMs:r,isPaused:!1},a},pause:function(t){var r=e[t];if(r&&!r.isPaused){var n=Date.now()-r.timeStartedMs;r.timeRemainingMs-=n,r.isPaused=!0,window.clearTimeout(r.timeoutId)}},resume:function(t){var r=e[t];if(r&&r.isPaused){r.timeStartedMs=Date.now(),r.isPaused=!1;var n=window.setTimeout((function(){delete e[t],r.callback()}),r.timeRemainingMs);r.timeoutId=n}},cancel:function(t){var r=e[t];r&&(window.clearTimeout(r.timeoutId),delete e[t])}}}function ve(){return(ve=Object(_.a)(A.a.mark((function e(t,r){var n,a,i;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r;case 2:return n=e.sent,e.next=5,n.arrayBuffer();case 5:return a=e.sent,e.next=8,new Promise((function(e,r){t.decodeAudioData(a,e,r)}));case 8:return i=e.sent,e.abrupt("return",i);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function me(e,t){return function(r){if(!t[r])throw Error('Audio file "'+r+'" was not preloaded');var n=t[r].data;if("then"in n)throw Error('Audio file "'+r+'" did not finish loading before it was used');var a=n.buffer,i=n.playState;return{getPosition:function(){return he(e,n.playState)},play:function(o){var u,s=!1,l=!1,c=1;if("number"==typeof o)u=o;else if(o){u=o.fromPosition;var d=o.loop;s=void 0===d?s:d;var p=o.overwrite;l=void 0===p?l:p;var f=o.playbackRate;c=void 0===f?c:f}var v=e.createBufferSource();v.buffer=a,v.playbackRate.value=c;var m=e.createGain();v.connect(m),m.connect(e.destination);var h=null!=u?u:he(e,i);try{v.start(void 0,h)}catch(y){return}v.loop=s,v.onended=function(){var e;if(t[r]){var n=t[r].data;"then"in n||!1!==(null===(e=n.playState)||void 0===e?void 0:e.isPaused)||delete n.playState}};var g=i&&!i.isPaused;g&&!l||(i&&g&&(i.sample.onended=null,i.sample.stop()),n.playState={playTime:e.currentTime,sample:v,alreadyPlayedTime:h,isPaused:!1,gainNode:m})},pause:function(){i&&!i.isPaused&&(i.sample.onended=null,i.sample.stop(),n.playState=Object.assign({},i,{alreadyPlayedTime:he(e,i),isPaused:!0}))},getStatus:function(){return n.playState&&!1===n.playState.isPaused?"playing":"paused"},getDuration:function(){return a.duration},getVolume:function(){return n.playState?n.playState.gainNode.gain.value:1},setVolume:function(t){var r=n.playState;if(r)if("number"==typeof t)r.gainNode.gain.setValueAtTime(Math.max(Math.min(1,t),0),e.currentTime);else{var a=t.type,i=t.fadeTo,o=t.fadeTime,u=Math.max(Math.min(1,i),0);"linear"===a?r.gainNode.gain.linearRampToValueAtTime(u,e.currentTime+o):r.gainNode.gain.exponentialRampToValueAtTime(u,e.currentTime+o)}}}}}function he(e,t){return t?t.isPaused?t.alreadyPlayedTime:(e.currentTime-t.playTime)*t.sample.playbackRate.value+t.alreadyPlayedTime:0}function ge(){return{get:function(e,t){fetch(e).then((function(e){return e.json()})).then(t)},post:function(e,t,r){fetch(e,{method:"POST",body:JSON.stringify(t)}).then((function(e){return e.json()})).then(r)},put:function(e,t,r){fetch(e,{method:"PUT",body:JSON.stringify(t)}).then((function(e){return e.json()})).then(r)},delete:function(e,t){fetch(e,{method:"DELETE"}).then((function(e){return e.json()})).then(t)}}}function ye(){return{getItem:(t=Object(_.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",localStorage.getItem(t));case 1:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)}),setItem:(e=Object(_.a)(A.a.mark((function e(t,r){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==r){e.next=3;break}return localStorage.removeItem(t),e.abrupt("return");case 3:localStorage.setItem(t,r);case 4:case"end":return e.stop()}}),e)}))),function(t,r){return e.apply(this,arguments)})};var e,t}var xe="__replay_resolution_v1__";function be(){return{copy:function(e,t){navigator.clipboard?navigator.clipboard.writeText(e).then((function(){t()})).catch((function(e){t(e)})):t(new Error(window.isSecureContext?"Couldn't access clipboard":"Clipboard only available on HTTPS or localhost"))}}}function Ae(){if("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch)return!0;return window.matchMedia("(touch-enabled),(-webkit-touch-enabled),(-moz-touch-enabled),(-o-touch-enabled),(-ms-touch-enabled)").matches}function _e(e,t,r){var n=we(e,e.VERTEX_SHADER,t),a=we(e,e.FRAGMENT_SHADER,r),i=e.createProgram();if(e.attachShader(i,n),e.attachShader(i,a),e.linkProgram(i),e.getProgramParameter(i,e.LINK_STATUS))return i;throw Error(e.getProgramInfoLog(i)||"")}function we(e,t,r){var n=e.createShader(t);if(e.shaderSource(n,r),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS))return n;throw Error(e.getShaderInfoLog(n)||"")}var Ee={black:"#000000",silver:"#c0c0c0",gray:"#808080",white:"#ffffff",maroon:"#800000",red:"#ff0000",purple:"#800080",fuchsia:"#ff00ff",green:"#008000",lime:"#00ff00",olive:"#808000",yellow:"#ffff00",navy:"#000080",blue:"#0000ff",teal:"#008080",aqua:"#00ffff"},Se={r:0,g:0,b:0};function Te(e,t){e.startsWith("#")||(e=Ee[e]||Ee.black);var r=Number.parseInt(e.slice(1),16),n=r>>16,a=r>>8&255,i=255&r;return void 0!==t?(Se.r=t*(n/255),Se.g=t*(a/255),Se.b=t*(i/255)):(Se.r=n/255,Se.g=a/255,Se.b=i/255),Se}function Re(e,t,r,n,a,i,o,u){var s=t.colors.length;e.uniform1i(r,0),e.uniform1f(n,s),"linearHoriz"===t.type?(e.uniform1f(a,t.width/o),e.uniform1i(i,1)):(e.uniform1f(a,t.height/u),e.uniform1i(i,0))}function Pe(e,t){var r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR);var n=t.colors.length;return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n,1,0,e.RGBA,e.UNSIGNED_BYTE,function(e){for(var t=Array.from({length:4*e.colors.length}),r=0;r<e.colors.length;r++){var n=Te(e.colors[r]),a=n.r,i=n.g,o=n.b,u=1;if(e.opacities){var s=e.opacities[r];void 0!==s&&(u=s)}var l=4*r;t[l]=255*a,t[l+1]=255*i,t[l+2]=255*o,t[l+3]=255*u}return new Uint8Array(t)}(t)),r}function ke(e,t,r){var n=_e(e,"\nattribute vec2 a_position;\nattribute vec2 a_texcoord;\n\nuniform mat3 u_matrix;\nuniform mat3 u_texture_matrix;\n\nvarying vec2 v_texcoord;\n\nconst mat3 flipY = mat3(\n  1.0, 0.0, 0.0,\n  0.0, -1.0, 0.0,\n  0.0, 1.0, 1.0\n);\n\nvoid main() {\n  gl_Position = vec4(u_matrix * vec3(a_position, 1.0), 1.0);\n  v_texcoord = (flipY * u_texture_matrix * vec3(a_texcoord, 1.0)).xy;\n}","\nprecision mediump float;\n\nvarying vec2 v_texcoord;\n\nuniform sampler2D u_texture;\nuniform float u_opacity;\n\nvoid main() {\n  gl_FragColor = texture2D(u_texture, v_texcoord) * u_opacity;\n}\n"),a=t.createVertexArrayOES();t.bindVertexArrayOES(a);var i=e.getAttribLocation(n,"a_position"),o=e.getAttribLocation(n,"a_texcoord"),u=e.getUniformLocation(n,"u_matrix"),s=e.getUniformLocation(n,"u_texture_matrix"),l=e.getUniformLocation(n,"u_texture"),c=e.getUniformLocation(n,"u_opacity"),d=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,d),e.enableVertexAttribArray(i),e.vertexAttribPointer(i,2,e.FLOAT,!1,0,0);e.bufferData(e.ARRAY_BUFFER,new Float32Array([-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,.5,.5]),e.STATIC_DRAW);var p=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,p),e.enableVertexAttribArray(o),e.vertexAttribPointer(o,2,e.FLOAT,!1,0,0);e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1]),e.STATIC_DRAW),t.bindVertexArrayOES(null);var f=F.getNewIdentity3fv(),v=F.getNewIdentity3fv();return function(i,o,d,p,m,h){i!==r.texture&&(e.bindTexture(e.TEXTURE_2D,i),r.texture=i),n!==r.program&&(e.useProgram(n),r.program=n,t.bindVertexArrayOES(a)),F.scaleToUniform3fvMut(o,d,p,f),e.uniformMatrix3fv(u,!1,f),function(e,t){if(!e)return void F.toUniform3fvMut(F.identityMatrix,t);var r=e.columns,n=e.rows,a=e.index,i=a%r,o=Math.floor(a/r)%n,u=F.multiplyPooled(F.getTranslateMatrixPooled(i/r,(n-1-o)/n),F.getScaleMatrixPooled(1/r,1/n));F.toUniform3fvMut(u,t)}(h,v),e.uniformMatrix3fv(s,!1,v),e.uniform1i(l,0),e.uniform1f(c,m),e.drawArrays(e.TRIANGLES,0,6)}}function Ie(e,t){var r=e.createTexture();return e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),r}function Fe(e,t,r,n,a){var i=Object.assign({},n,e.font),o=i.size,u=void 0===o?10:o,s=i.weight,l=void 0===s?"normal":s,c=i.style,d=void 0===c?"normal":c,p=i.family,f=i.align,v=void 0===f?"center":f,m=i.baseline,h=void 0===m?"middle":m,g=d+" "+l+" "+(u?u+"px":"")+" "+(p?""+p:""),y=e.text,x=e.strokeThickness,b=void 0===x?1:x,A=e.color;return function(e,t,r,n,a){var i=r*n,o=r*a;i!==e.width||o!==e.height?(e.width=i,e.height=o,t.translate(i/2,o/2),t.scale(r,r)):t.clearRect(-i/2,-o/2,e.width,e.height)}(t,r,a,function(e,t,r,n){return e.font=n,e.measureText(t).width+2*r}(r,y,b,g),1.5*u*("middle"!==h?2:1)),function(e,t,r,n,a,i,o,u,s){e.font=t,e.textBaseline=i,e.textAlign=o,s&&(e.strokeStyle=s,e.lineWidth=a,e.strokeText(r,0,0));e.fillStyle=u?Le(e,u):n,e.fillText(r,0,0)}(r,g,y,A,b,h,"center",e.gradient,e.strokeColor),v}var Le=function(e,t){for(var r="linearHoriz"===t.type?e.createLinearGradient(-t.width/2,0,t.width/2,0):e.createLinearGradient(0,-t.height/2,0,t.height/2),n=0;n<t.colors.length;n++){var a=t.colors[n];if(t.opacities){var i=t.opacities[n];if(void 0!==i){var o=Te(a);a="rgba("+255*o.r+", "+255*o.g+", "+255*o.b+", "+i}}var u=n/(t.colors.length-1);r.addColorStop(u,a)}return r};function Oe(e,t,r){var n=_e(e,"\nattribute vec2 a_origin;\nattribute vec2 a_point1;\nattribute vec2 a_point2;\n\nuniform mat3 u_matrix;\nuniform float u_half_thickness;\n\nvoid main() {\n  if (a_point1 == a_point2) {\n    // Avoid normalize a zero vector\n    gl_Position = vec4(u_matrix * vec3(a_origin, 1.0), 1.0);\n    return;\n  }\n\n  vec2 normal = normalize(a_point2 - a_point1);\n  vec2 tangent = vec2(-normal.y, normal.x);\n  vec2 pos = a_origin + tangent * u_half_thickness;\n\n  gl_Position = vec4(u_matrix * vec3(pos, 1.0), 1.0);\n}\n","\nprecision mediump float;\n\nuniform vec4 u_colour;\n\nvoid main() {\n  gl_FragColor = u_colour;\n}\n"),a=t.createVertexArrayOES(),i=t.createVertexArrayOES(),o=e.getAttribLocation(n,"a_point1"),u=e.getAttribLocation(n,"a_point2"),s=e.getAttribLocation(n,"a_origin"),l=e.getUniformLocation(n,"u_matrix"),c=e.getUniformLocation(n,"u_half_thickness"),d=e.getUniformLocation(n,"u_colour"),p=e.createBuffer();t.bindVertexArrayOES(a),e.bindBuffer(e.ARRAY_BUFFER,p),e.enableVertexAttribArray(o),e.vertexAttribPointer(o,2,e.FLOAT,!1,24,8),e.enableVertexAttribArray(u),e.vertexAttribPointer(u,2,e.FLOAT,!1,24,16),e.enableVertexAttribArray(s),e.vertexAttribPointer(s,2,e.FLOAT,!1,24,0),t.bindVertexArrayOES(i),e.bindBuffer(e.ARRAY_BUFFER,p),e.enableVertexAttribArray(s),e.vertexAttribPointer(s,2,e.FLOAT,!1,96,0),e.disableVertexAttribArray(o),e.disableVertexAttribArray(u),t.bindVertexArrayOES(null);var f=F.getNewIdentity3fv();return function(o,u,s,v,m,h,g,y){if(s.length<=1)u.lineCaps=null;else{if(n!==r.program&&(e.useProgram(n),r.program=n,e.bindBuffer(e.ARRAY_BUFFER,p)),function(e,t){var r=24,n=t.length*r;e.strokePath.length!==n&&(e.strokePath=new Float32Array(n));for(var a=e.strokePath,i=void 0,o=void 0,u=void 0,s=void 0,l=t[0][0],c=t[0][1],d=0;d<t.length;d++){var p=d*r;i=u,o=s,u=l,s=c;var f=t[d+1];f?(l=f[0],c=f[1]):(l=u,c=s),void 0!==i&&void 0!==o||(i=u,o=s),a[p]=u,a[p+1]=s,a[p+2]=i,a[p+3]=o,a[p+4]=u,a[p+5]=s,a[p+6]=u,a[p+7]=s,a[p+8]=u,a[p+9]=s,a[p+10]=i,a[p+11]=o,a[p+12]=u,a[p+13]=s,a[p+14]=u,a[p+15]=s,a[p+16]=l,a[p+17]=c,a[p+18]=u,a[p+19]=s,a[p+20]=l,a[p+21]=c,a[p+22]=u,a[p+23]=s}}(u,s),e.bufferData(e.ARRAY_BUFFER,u.strokePath,e.DYNAMIC_DRAW),F.toUniform3fvMut(o,f),e.uniformMatrix3fv(l,!1,f),e.uniform1f(c,v/2),h){var x=Te(h,y),b=x.r,A=x.g,_=x.b;e.uniform4f(d,b,A,_,y),t.bindVertexArrayOES(i),e.drawArrays(e.TRIANGLE_FAN,0,s.length)}if(m){var w=Te(m,y),E=w.r,S=w.g,T=w.b;e.uniform4f(d,E,S,T,y),t.bindVertexArrayOES(a),e.drawArrays(e.TRIANGLE_STRIP,0,4*s.length),"round"===g?function(e,t){var r=e[0],n=e[1],a=e[e.length-2],i=e[e.length-1];t.lineCaps||(t.lineCaps=[{x:0,y:0,angleRad:0,textureState:{points:new Float32Array}},{x:0,y:0,angleRad:0,textureState:{points:new Float32Array}}]);t.lineCaps[0].x=r[0],t.lineCaps[0].y=r[1],t.lineCaps[0].angleRad=Math.atan2(n[1]-r[1],n[0]-r[0])+Math.PI/2,t.lineCaps[1].x=i[0],t.lineCaps[1].y=i[1],t.lineCaps[1].angleRad=Math.atan2(i[1]-a[1],i[0]-a[0])-Math.PI/2}(s,u):u.lineCaps=null}else u.lineCaps=null}}}function Me(e,t,r){var n=_e(e,"\nattribute vec2 a_point;\n\nuniform mat3 u_matrix;\nuniform bool u_horizontal;\nuniform float u_ramp_width;\nuniform float u_gradient_length;\n\nvarying float ramp_distance;\n\nvoid main() {\n  float grad_coord = 0.0;\n\n  if (u_horizontal) {\n    grad_coord = a_point.x;\n  } else {\n    grad_coord = -a_point.y;\n  }\n\n  // mixValue varies from 0 -> 1 along gradient length\n  float mixValue = 0.5 + grad_coord / u_gradient_length;\n\n  float rampPixelLength = 1.0 / u_ramp_width;\n\n  ramp_distance =\n    // Left offset to middle of pixel\n    rampPixelLength / 2.0 +\n    // Distance along ramp width\n    mixValue * (1.0 - rampPixelLength);\n\n  gl_Position = vec4(u_matrix * vec3(a_point, 1.0), 1.0);\n}\n","\nprecision mediump float;\n\nuniform sampler2D u_ramp_texture;\nuniform float u_opacity;\n\nvarying float ramp_distance;\n\nvoid main() {\n  gl_FragColor = texture2D(\n    u_ramp_texture,\n    vec2(ramp_distance, 0.5)\n  ) * u_opacity;\n}\n"),a=t.createVertexArrayOES();t.bindVertexArrayOES(a);var i=e.getAttribLocation(n,"a_point"),o=e.getUniformLocation(n,"u_matrix"),u=e.getUniformLocation(n,"u_ramp_texture"),s=e.getUniformLocation(n,"u_ramp_width"),l=e.getUniformLocation(n,"u_gradient_length"),c=e.getUniformLocation(n,"u_horizontal"),d=e.getUniformLocation(n,"u_opacity"),p=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,p),e.enableVertexAttribArray(i),e.vertexAttribPointer(i,2,e.FLOAT,!1,0,0),t.bindVertexArrayOES(null);var f=F.getNewIdentity3fv();return function(i,v,m,h,g,y){h.length<=1||(m!==r.texture&&(e.bindTexture(e.TEXTURE_2D,m),r.texture=m),n!==r.program&&(e.useProgram(n),r.program=n,t.bindVertexArrayOES(a),e.bindBuffer(e.ARRAY_BUFFER,p)),function(e,t){var r=2*e.length;t.linePath.length!==r&&(t.linePath=new Float32Array(r));for(var n=t.linePath,a=0;a<e.length;a++){var i=e[a],o=i[0],u=i[1],s=2*a;n[s]=o,n[s+1]=u}}(h,v),e.bufferData(e.ARRAY_BUFFER,v.linePath,e.DYNAMIC_DRAW),F.toUniform3fvMut(i,f),e.uniformMatrix3fv(o,!1,f),e.uniform1f(d,y),Re(e,g,u,s,l,c,1,1),e.drawArrays(e.TRIANGLE_FAN,0,h.length))}}function Ce(e,t,r){var n=_e(e,"\n#define PI 3.1415926538\n\nattribute float a_vertex;\nuniform float u_num_vertex;\nuniform float u_radius;\nuniform float u_angle_multiplier;\n\nuniform mat3 u_matrix;\n\nvoid main() {\n  if (a_vertex < 0.0) {\n    // Origin\n    gl_Position = vec4(u_matrix * vec3(0.0, 0.0, 1.0), 1.0);\n    return;\n  }\n  float dr = a_vertex / u_num_vertex;\n  float angle = dr * PI * 2.0 * u_angle_multiplier;\n\n  vec2 position = vec2(cos(angle), sin(angle)) * u_radius;\n\n  gl_Position = vec4(u_matrix * vec3(position, 1.0), 1.0);\n}\n","\nprecision mediump float;\n\nuniform vec4 u_colour;\n\nvoid main() {\n  gl_FragColor = u_colour;\n}\n"),a=t.createVertexArrayOES();t.bindVertexArrayOES(a);var i=e.getAttribLocation(n,"a_vertex"),o=e.getUniformLocation(n,"u_num_vertex"),u=e.getUniformLocation(n,"u_radius"),s=e.getUniformLocation(n,"u_angle_multiplier"),l=e.getUniformLocation(n,"u_matrix"),c=e.getUniformLocation(n,"u_colour"),d=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,d),e.enableVertexAttribArray(i),e.vertexAttribPointer(i,1,e.FLOAT,!1,0,0),t.bindVertexArrayOES(null);var p=F.getNewIdentity3fv();return function(i,f,v,m,h,g,y,x,b){n!==r.program&&(e.useProgram(n),r.program=n,t.bindVertexArrayOES(a),e.bindBuffer(e.ARRAY_BUFFER,d));var A=F.getScalePooled(i),_=A.scaleX,w=A.scaleY,E=Math.max(_*h,w*g)/2,S=Math.ceil(Math.PI*m*E*y);!function(e,t){var r=t+2;if(e.points.length!==r){e.points=new Float32Array(r);for(var n=-1;n<r-1;n++)e.points[n]=n}}(f,S),e.bufferData(e.ARRAY_BUFFER,f.points,e.DYNAMIC_DRAW),F.toUniform3fvMut(i,p),e.uniformMatrix3fv(l,!1,p);var T=Te(v,x),R=T.r,P=T.g,k=T.b;e.uniform4f(c,R,P,k,x),e.uniform1f(o,S),e.uniform1f(u,m),e.uniform1f(s,b?.5:1),e.drawArrays(e.TRIANGLE_FAN,0,S+2)}}function Ue(e,t,r,n){var a=_e(e,"\nattribute vec2 a_position;\nattribute vec2 a_texcoord;\nattribute vec4 a_matrix_abcd;\nattribute vec2 a_matrix_txty;\nattribute float a_opacity;\n\nvarying vec2 v_texcoord;\nvarying float v_opacity;\n\nconst mat3 flipY = mat3(\n  1.0, 0.0, 0.0,\n  0.0, -1.0, 0.0,\n  0.0, 1.0, 1.0\n);\n\nvoid main() {\n  mat3 matrix = mat3(\n    a_matrix_abcd.x, a_matrix_abcd.y, 0,\n    a_matrix_abcd.z, a_matrix_abcd.w, 0,\n    a_matrix_txty.x, a_matrix_txty.y, 1\n  );\n  gl_Position = vec4(matrix * vec3(a_position, 1.0), 1.0);\n  v_texcoord = (flipY * vec3(a_texcoord, 1.0)).xy;\n  v_opacity = a_opacity;\n}","\nprecision mediump float;\n\nvarying vec2 v_texcoord;\nvarying float v_opacity;\n\nuniform sampler2D u_texture;\n\nvoid main() {\n  gl_FragColor = texture2D(u_texture, v_texcoord) * v_opacity;\n}\n"),i=r.createVertexArrayOES();r.bindVertexArrayOES(i);var o=e.getAttribLocation(a,"a_position"),u=e.getAttribLocation(a,"a_texcoord"),s=e.getAttribLocation(a,"a_matrix_abcd"),l=e.getAttribLocation(a,"a_matrix_txty"),c=e.getAttribLocation(a,"a_opacity"),d=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,d),e.enableVertexAttribArray(o),e.vertexAttribPointer(o,2,e.FLOAT,!1,0,0);e.bufferData(e.ARRAY_BUFFER,new Float32Array([-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,.5,.5]),e.STATIC_DRAW);var p=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,p),e.enableVertexAttribArray(u),e.vertexAttribPointer(u,2,e.FLOAT,!1,0,0);e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1]),e.STATIC_DRAW);var f=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,f),e.enableVertexAttribArray(s),e.vertexAttribPointer(s,4,e.FLOAT,!1,24,0),t.vertexAttribDivisorANGLE(s,1),e.enableVertexAttribArray(l),e.vertexAttribPointer(l,2,e.FLOAT,!1,24,16),t.vertexAttribDivisorANGLE(l,1);var v=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,v),e.enableVertexAttribArray(c),e.vertexAttribPointer(c,1,e.FLOAT,!1,0,0),t.vertexAttribDivisorANGLE(c,1),r.bindVertexArrayOES(null),function(o,u,s,l,c){o!==n.texture&&(e.bindTexture(e.TEXTURE_2D,o),n.texture=o),a!==n.program&&(e.useProgram(a),n.program=a,r.bindVertexArrayOES(i)),function(e,t,r,n){var a=6,i=t.length*a;e.matrices.length!==i&&(e.matrices=new Float32Array(i));var o=e.matrices,u=t.length;e.opacities.length!==u&&(e.opacities=new Float32Array(u));for(var s=e.opacities,l=0;l<t.length;l++){var c=t[l],d=j(r,c,c.width,c.height),p=l*a;o[p]=d[0],o[p+1]=d[1],o[p+2]=d[2],o[p+3]=d[3],o[p+4]=d[4],o[p+5]=d[5],s[l]=c.show?c.opacity*n:0}}(u,c,s,l),e.bindBuffer(e.ARRAY_BUFFER,f),e.bufferData(e.ARRAY_BUFFER,u.matrices,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,v),e.bufferData(e.ARRAY_BUFFER,u.opacities,e.DYNAMIC_DRAW),t.drawArraysInstancedANGLE(e.TRIANGLES,0,6,c.length)}}function Ne(e,t,r,n){var a=_e(e,"\nattribute vec2 a_position;\nattribute vec4 a_matrix_abcd;\nattribute vec2 a_matrix_txty;\nattribute vec4 a_colour;\n\nvarying vec4 v_colour;\n\nvoid main() {\n  mat3 matrix = mat3(\n    a_matrix_abcd.x, a_matrix_abcd.y, 0,\n    a_matrix_abcd.z, a_matrix_abcd.w, 0,\n    a_matrix_txty.x, a_matrix_txty.y, 1\n  );\n  gl_Position = vec4(matrix * vec3(a_position, 1.0), 1.0);\n  v_colour = a_colour;\n}\n","\nprecision mediump float;\n\nvarying vec4 v_colour;\n\nvoid main() {\n  gl_FragColor = v_colour;\n}\n"),i=r.createVertexArrayOES();r.bindVertexArrayOES(i);var o=e.getAttribLocation(a,"a_position"),u=e.getAttribLocation(a,"a_matrix_abcd"),s=e.getAttribLocation(a,"a_matrix_txty"),l=e.getAttribLocation(a,"a_colour"),c=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,c),e.enableVertexAttribArray(o),e.vertexAttribPointer(o,2,e.FLOAT,!1,0,0);e.bufferData(e.ARRAY_BUFFER,new Float32Array([-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,.5,.5]),e.STATIC_DRAW);var d=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,d),e.enableVertexAttribArray(u),e.vertexAttribPointer(u,4,e.FLOAT,!1,24,0),t.vertexAttribDivisorANGLE(u,1),e.enableVertexAttribArray(s),e.vertexAttribPointer(s,2,e.FLOAT,!1,24,16),t.vertexAttribDivisorANGLE(s,1);var p=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,p),e.enableVertexAttribArray(l),e.vertexAttribPointer(l,4,e.FLOAT,!1,0,0),t.vertexAttribDivisorANGLE(l,1),r.bindVertexArrayOES(null),function(o,u,s,l){a!==n.program&&(e.useProgram(a),n.program=a,r.bindVertexArrayOES(i)),function(e,t,r,n){var a=6,i=4,o=n.length*a;e.matrices.length!==o&&(e.matrices=new Float32Array(o));var u=e.matrices,s=n.length*i;e.colours.length!==s&&(e.colours=new Float32Array(s));for(var l=e.colours,c=0;c<n.length;c++){var d=n[c],p=j(t,d,d.width,d.height),f=c*a;u[f]=p[0],u[f+1]=p[1],u[f+2]=p[2],u[f+3]=p[3],u[f+4]=p[4],u[f+5]=p[5];var v=d.show?r*d.opacity:0,m=Te(d.color,v),h=m.r,g=m.g,y=m.b,x=c*i;l[x]=h,l[x+1]=g,l[x+2]=y,l[x+3]=v}}(u,o,s,l),e.bindBuffer(e.ARRAY_BUFFER,d),e.bufferData(e.ARRAY_BUFFER,u.matrices,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,p),e.bufferData(e.ARRAY_BUFFER,u.colours,e.DYNAMIC_DRAW),t.drawArraysInstancedANGLE(e.TRIANGLES,0,6,l.length)}}function Be(e,t,r,n,a,i,o,u,s,l){var c=e.canvas.width,d=e.canvas.height,p=c*l/a;e.viewport(0,0,c,d);var f=n.getContext("2d"),v={texture:null,program:null},m=ke(e,r,v),h=Ue(e,t,r,v),g=function(e,t,r){var n=_e(e,"\nattribute vec2 a_position;\n\nuniform mat3 u_matrix;\n\nvoid main() {\n  gl_Position = vec4(u_matrix * vec3(a_position, 1.0), 1.0);\n}\n","\nprecision mediump float;\n\nuniform vec4 u_colour;\n\nvoid main() {\n  gl_FragColor = u_colour;\n}\n"),a=t.createVertexArrayOES();t.bindVertexArrayOES(a);var i=e.getAttribLocation(n,"a_position"),o=e.getUniformLocation(n,"u_matrix"),u=e.getUniformLocation(n,"u_colour"),s=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,s),e.enableVertexAttribArray(i),e.vertexAttribPointer(i,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,.5,.5]),e.STATIC_DRAW),t.bindVertexArrayOES(null);var l=F.getNewIdentity3fv();return function(i,s,c,d,p){n!==r.program&&(e.useProgram(n),r.program=n,t.bindVertexArrayOES(a));var f=F.multiplyPooled(i,F.getScaleMatrixPooled(c,d));F.toUniform3fvMut(f,l),e.uniformMatrix3fv(o,!1,l);var v=Te(s,p),m=v.r,h=v.g,g=v.b;e.uniform4f(u,m,h,g,p),e.drawArrays(e.TRIANGLES,0,6)}}(e,r,v),y=Ne(e,t,r,v),x=function(e,t,r){var n=_e(e,"\nattribute vec2 a_point;\n\nuniform mat3 u_matrix;\nuniform bool u_horizontal;\nuniform float u_ramp_width;\nuniform float u_gradient_length;\n\nvarying float ramp_distance;\n\nvoid main() {\n  float grad_coord = 0.0;\n\n  if (u_horizontal) {\n    grad_coord = a_point.x;\n  } else {\n    grad_coord = -a_point.y;\n  }\n\n  // grad_coord = -0.5 / 0.5 is edges of rect\n  // mixValue varies from 0 -> 1 along gradient length\n  float mixValue = 0.5 + grad_coord / u_gradient_length;\n\n  float rampPixelLength = 1.0 / u_ramp_width;\n\n  ramp_distance =\n    // Left offset to middle of pixel\n    rampPixelLength / 2.0 +\n    // Distance along ramp width\n    mixValue * (1.0 - rampPixelLength);\n\n  gl_Position = vec4(u_matrix * vec3(a_point, 1.0), 1.0);\n}\n","\nprecision mediump float;\n\nuniform sampler2D u_ramp_texture;\nuniform float u_opacity;\n\nvarying float ramp_distance;\n\nvoid main() {\n  gl_FragColor = texture2D(\n    u_ramp_texture,\n    vec2(ramp_distance, 0.5)\n  ) * u_opacity;\n}\n"),a=t.createVertexArrayOES();t.bindVertexArrayOES(a);var i=e.getAttribLocation(n,"a_point"),o=e.getUniformLocation(n,"u_matrix"),u=e.getUniformLocation(n,"u_ramp_texture"),s=e.getUniformLocation(n,"u_ramp_width"),l=e.getUniformLocation(n,"u_gradient_length"),c=e.getUniformLocation(n,"u_horizontal"),d=e.getUniformLocation(n,"u_opacity"),p=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,p),e.enableVertexAttribArray(i),e.vertexAttribPointer(i,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,.5,.5]),e.STATIC_DRAW),t.bindVertexArrayOES(null);var f=F.getNewIdentity3fv();return function(i,p,v,m,h,g){p!==r.texture&&(e.bindTexture(e.TEXTURE_2D,p),r.texture=p),n!==r.program&&(e.useProgram(n),r.program=n,t.bindVertexArrayOES(a));var y=F.multiplyPooled(i,F.getScaleMatrixPooled(m,h));F.toUniform3fvMut(y,f),e.uniformMatrix3fv(o,!1,f),e.uniform1f(d,g),Re(e,v,u,s,l,c,m,h),e.drawArrays(e.TRIANGLES,0,6)}}(e,r,v),b=Oe(e,r,v),A=Me(e,r,v),_=Ce(e,r,v),E=function(e,t,r){var n=_e(e,"\nattribute vec2 a_position;\nattribute vec2 a_texcoord;\n\nuniform mat3 u_matrix;\n\nvarying vec2 v_texcoord;\n\nconst mat3 flipY = mat3(\n  1.0, 0.0, 0.0,\n  0.0, -1.0, 0.0,\n  0.0, 1.0, 1.0\n);\n\nvoid main() {\n  gl_Position = vec4(u_matrix * vec3(a_position, 1.0), 1.0);\n  v_texcoord = (flipY * vec3(a_texcoord, 1.0)).xy;\n}","\nprecision mediump float;\n\nvarying vec2 v_texcoord;\n\nuniform sampler2D u_texture;\nuniform float u_opacity;\n\nvoid main() {\n  gl_FragColor = texture2D(u_texture, v_texcoord) * u_opacity;\n}\n"),a=t.createVertexArrayOES();t.bindVertexArrayOES(a);var i=e.getAttribLocation(n,"a_position"),o=e.getAttribLocation(n,"a_texcoord"),u=e.getUniformLocation(n,"u_matrix"),s=e.getUniformLocation(n,"u_texture"),l=e.getUniformLocation(n,"u_opacity"),c=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,c),e.enableVertexAttribArray(i),e.vertexAttribPointer(i,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,.5,.5]),e.STATIC_DRAW);var d=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,d),e.enableVertexAttribArray(o),e.vertexAttribPointer(o,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1]),e.STATIC_DRAW),t.bindVertexArrayOES(null);var p=F.getNewIdentity3fv();return function(i,o,c,d,f,v){e.bindTexture(e.TEXTURE_2D,i),r.texture=i,n!==r.program&&(e.useProgram(n),r.program=n,t.bindVertexArrayOES(a));var m=F.multiplyPooled(o,F.getScaleMatrixPooled(c/v,d/v));F.toUniform3fvMut(m,p),e.uniformMatrix3fv(u,!1,p),e.uniform1i(s,0),e.uniform1f(l,f),e.drawArrays(e.TRIANGLES,0,6)}}(e,r,v);function S(t,r,n,o,u){var s,c;if(t){if(e.isEnabled(e.STENCIL_TEST))throw Error("Nested masks not supported");e.enable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.stencilFunc(e.ALWAYS,1,255),e.stencilOp(e.KEEP,e.KEEP,e.REPLACE);var d=F.multiply(void 0===o||void 0===u||0===o&&0===u?n:F.multiply(n,F.getTranslateMatrix(o,u)),F.getTranslateMatrix(t.x,t.y));switch(e.colorMask(!1,!1,!1,!1),t.type){case"circleMask":null===r&&(r={value:null}),"circleMask"!==(null===(s=r.value)||void 0===s?void 0:s.type)&&(r.value={type:"circleMask",points:new Float32Array}),_(d,r.value,"",t.radius,a,i,l,1,!1);break;case"lineMask":null===r&&(r={value:null}),"lineMask"!==(null===(c=r.value)||void 0===c?void 0:c.type)&&(r.value={type:"lineMask",lineCaps:null,linePath:new Float32Array,strokePath:new Float32Array}),b(d,r.value,t.path,0,void 0," ","butt",1);break;case"rectangleMask":g(d,"",t.width,t.height,1)}e.colorMask(!0,!0,!0,!0),e.stencilFunc(e.EQUAL,1,255),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}}function T(){e.disable(e.STENCIL_TEST)}var R={},P=new Set,k=[0,0,0,0,0,0],I=Te(s),L=I.r,O=I.g,M=I.b;function C(t,r,n){var o=t.fillGradient;if(o){var u=o.type+"-"+o.colors.join("")+"-"+(o.opacities||[]).join(""),s=R[u];s?P.delete(u):(s={texture:Pe(e,o),width:0,height:0,align:"center"},R[u]=s),A(k,n,s.texture,t.path,o,t.opacity*r)}if(t.color||t.fillColor){b(k,n,t.path,t.thickness,t.color,t.fillColor,t.lineCap,t.opacity*r);var l=t.color;if(n.lineCaps&&l)for(var c,d=Object(w.a)(n.lineCaps);!(c=d()).done;){var f=c.value,v=F.multiplyPooled(F.getTranslateMatrixPooled(f.x,f.y),F.getRotateMatrixPooled(f.angleRad)),m=F.multiplyPooled(k,v);_(m,f.textureState,l,t.thickness/2,a,i,p,t.opacity*r,!0)}}}function U(t,r){var a=t.text,i=t.color,o=t.strokeColor,s=t.font,c=s?a+"-"+i+"-"+o+"-"+s.size+"-"+s.weight+"-"+s.style+"-"+s.align:a+"-"+i+"-"+o,d=R[c];if(d)P.delete(c);else{var p=Fe(t,n,f,u,l);d={texture:Ie(e,n),width:n.width,height:n.height,align:p},R[c]=d}var v=d,m=v.align,h=v.width,g=v.height;E(d.texture,"center"===m?k:F.multiplyPooled(k,F.getTranslateMatrixPooled(h/(2*l)*("left"===m?1:-1),0)),h,g,t.opacity*r,l)}return{newFrame:function(){e.clearColor(L,O,M,1),e.clear(e.COLOR_BUFFER_BIT);for(var t,r=Object(w.a)(P);!(t=r()).done;){var n=t.value;e.deleteTexture(R[n].texture),delete R[n]}for(var a in P.clear(),R)P.add(a);e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA)},endFrame:function(){r.bindVertexArrayOES(null),v.program=null,v.texture=null},startRenderSprite:function(e,t,r){S(e.mask,r,t.transformation)},endRenderSprite:function(e){e.hasMask&&T()},renderTexture:function(t,r,n,u){if("imageArray"===r.type){if(0===r.props.length)return;var s=n;S(r.mask,u,t.transformation);var l=De(o,r.fileName);return h(l.texture,s,t.transformation,t.opacity,r.props),void(r.mask&&T())}if("rectangleArray"===r.type){if(0===r.props.length)return;var c=n;return S(r.mask,u,t.transformation),y(t.transformation,c,t.opacity,r.props),void(r.mask&&T())}if("textArray"!==r.type)if("circleArray"!==r.type)if("lineArray"!==r.type){if(r.props.show){switch(B(t.transformation,k,r.props),S(r.props.mask,u,t.transformation,r.props.x,r.props.y),r.type){case"image":case"spriteSheet":var d=De(o,r.props.fileName);m(d.texture,k,r.props.width,r.props.height,r.props.opacity*t.opacity,"spriteSheet"===r.type?r.props:null);break;case"line":var f=n;C(r.props,t.opacity,f);break;case"rectangle":var v=r.props.gradient;if(v){var b=v.type+"-"+v.colors.join("")+"-"+(v.opacities||[]).join(""),A=R[b];A?P.delete(b):(A={texture:Pe(e,v),width:0,height:0,align:"center"},R[b]=A),x(k,A.texture,v,r.props.width,r.props.height,r.props.opacity*t.opacity)}else g(k,r.props.color,r.props.width,r.props.height,r.props.opacity*t.opacity);break;case"circle":_(k,n,r.props.color,r.props.radius,a,i,p,r.props.opacity*t.opacity,!1);break;case"text":U(r.props,t.opacity)}r.props.mask&&T()}}else{if(0===r.props.length)return;var E=n;S(r.mask,u,t.transformation),function(e,t){var r=t.props.length-e.stateByIndex.length;if(r>0)for(var n=0;n<r;n++)e.stateByIndex.push({lineCaps:null,linePath:new Float32Array,strokePath:new Float32Array});else r<0&&(e.stateByIndex.length=t.props.length)}(E,r);for(var I=0;I<r.props.length;I++){var F=r.props[I];F.show&&(B(t.transformation,k,F),C(F,t.opacity,E.stateByIndex[I]))}r.mask&&T()}else{if(0===r.props.length)return;var L=n;S(r.mask,u,t.transformation),function(e,t){var r=t.props.length-e.pointsByIndex.length;if(r>0)for(var n=0;n<r;n++)e.pointsByIndex.push({points:new Float32Array});else r<0&&(e.pointsByIndex.length=t.props.length)}(L,r);for(var O=0;O<r.props.length;O++){var M=r.props[O];M.show&&(B(t.transformation,k,M),_(k,L.pointsByIndex[O],M.color,M.radius,a,i,p,M.opacity*t.opacity,!1))}r.mask&&T()}else{if(0===r.props.length)return;S(r.mask,u,t.transformation);for(var N,D=Object(w.a)(r.props);!(N=D()).done;){var j=N.value;j.show&&(B(t.transformation,k,j),U(j,t.opacity))}r.mask&&T()}},startNativeSprite:function(){r.bindVertexArrayOES(null)},endNativeSprite:function(){v.program=null,v.texture=null,e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA)},getInitTextureState:function(e){switch(e.type){case"imageArray":return{matrices:new Float32Array,opacities:new Float32Array};case"line":return{lineCaps:null,linePath:new Float32Array,strokePath:new Float32Array};case"circle":return{points:new Float32Array};case"rectangleArray":return{matrices:new Float32Array,colours:new Float32Array};case"circleArray":return{pointsByIndex:Array.from({length:e.array().length}).map((function(){return{points:new Float32Array}}))};case"lineArray":return{stateByIndex:Array.from({length:e.array().length}).map((function(){return{lineCaps:null,linePath:new Float32Array,strokePath:new Float32Array}}))};default:return null}},getInitMaskState:function(e){if(null===e)return{value:null};switch(e.type){case"lineMask":return{value:{type:e.type,lineCaps:null,linePath:new Float32Array,strokePath:new Float32Array}};case"circleMask":return{value:{type:e.type,points:new Float32Array}};case"rectangleMask":return{value:null}}}}}var De=function(e,t){var r=e[t];if(!r)throw Error('Image file "'+t+'" was not preloaded');if("then"in r.data)throw Error('Image file "'+t+'" did not finish loading before it was used');return r.data},je={family:"sans-serif",size:12};function ze(e,t,r){var n=t||{},a=n.dimensions,i=void 0===a?"game-coords":a,o=n.canvas,u=n.nativeSpriteMap,s=void 0===u?{}:u,l=n.windowSize,c=n.statsBegin,d=n.statsEnd,p=n.imageResolution,f=void 0===p?3:p,v=n.maxPixels,m=o||document.createElement("canvas");o||document.body.appendChild(m),m.id="replay-canvas";var h=document.createElement("canvas"),g=window.PointerEvent?"pointerdown":"touchstart",y=window.PointerEvent?"pointermove":"touchmove",x=window.PointerEvent?"pointerup":"touchend",b=window.PointerEvent?"pointercancel":"touchcancel",A=m.getContext("webgl",{stencil:!0});if(!A)return Error("WebGL not supported");var _=A,w=_.getExtension("ANGLE_instanced_arrays");if(!w)return Error("WebGL instancing not supported");var E=w,S=_.getExtension("OES_vertex_array_object");if(!S)return Error("WebGL VAO not supported");var T=S;_.enable(_.BLEND),_.blendFunc(_.ONE,_.ONE_MINUS_SRC_ALPHA),_.pixelStorei(_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);var R=new(window.AudioContext||window.webkitAudioContext),P=!0,k=!0,I=0,L=!1,O=0,M=0,C=function(){document.hidden&&k&&(O=I,R.suspend()),document.hidden||k||(L=!0,setTimeout((function(){R.suspend(),setTimeout((function(){R.resume()}),75)}),75)),k=!document.hidden};document.addEventListener("keydown",(function(e){P&&!e.repeat&&ie(e)}),!1),document.addEventListener("keyup",(function(e){P&&oe(e)}),!1),document.addEventListener("visibilitychange",C,!1),window.addEventListener("resize",X,!1);var U,N,D,j,z,G=function(){return X({didScroll:!0})};function X(t){var r=Boolean(t&&"cleanup"in t&&t.cleanup),n=Boolean(t&&"didScroll"in t&&t.didScroll);if(!U||(document.removeEventListener(g,N),document.removeEventListener(y,D),document.removeEventListener(x,j),document.removeEventListener(b,z),!r)){n&&U||(te.size=pe((null==l?void 0:l.width)||window.innerWidth,(null==l?void 0:l.height)||window.innerHeight,i,e.props.size));var a,o,u=window.devicePixelRatio||1,s=te.size.deviceWidth*u*ee.resolution,c=te.size.fullWidth*f;s>c?(a=Math.round(c),o=Math.round(te.size.fullHeight*f)):(a=Math.round(s),o=Math.round(te.size.deviceHeight*u*ee.resolution));var d=a/te.size.fullWidth;if(v&&!ee.hasSet&&a*o>v&&ee.resolution>.15)return ee.resolution-=.1,void X();m.width=a,m.height=o,m.style.width=te.size.deviceWidth+"px",m.style.height=te.size.deviceHeight+"px";var p=e.props.defaultFont||je,A=e.props.backgroundColor||"white",w=te.size.width+2*te.size.widthMargin,S=te.size.height+2*te.size.heightMargin,R=Be(_,E,T,h,w,S,K,p,A,d),k=te.size.deviceWidth/w;$.newFrame=R.newFrame,$.endFrame=R.endFrame,$.startRenderSprite=R.startRenderSprite,$.endRenderSprite=R.endRenderSprite,$.renderTexture=R.renderTexture,$.startNativeSprite=R.startNativeSprite,$.endNativeSprite=R.endNativeSprite,$.getInitTextureState=R.getInitTextureState,$.getInitMaskState=R.getInitMaskState,he.gameXToPlatformX=function(e){var t=e.canvasOffsetLeft,r=e.widthMargin,n=e.scale,a=e.width;return function(e){return t+n*(e+a/2+r)}}({canvasOffsetLeft:m.offsetLeft,width:te.size.width,widthMargin:te.size.widthMargin,scale:k}),he.gameYToPlatformY=function(e){var t=e.canvasOffsetTop,r=e.heightMargin,n=e.scale,a=e.height;return function(e){return t-n*(e-a/2-r)}}({canvasOffsetTop:m.offsetTop,height:te.size.height,heightMargin:te.size.heightMargin,scale:k}),he.didResize=!0,he.scale=k,he.size=te.size;var I=function(e){var t=e.canvasOffsetLeft,r=e.scrollX,n=e.widthMargin,a=e.scale,i=e.width;return function(e){return(e.clientX-t+r)/a-n-i/2}}({canvasOffsetLeft:m.offsetLeft,scrollX:window.scrollX,width:te.size.width,widthMargin:te.size.widthMargin,scale:k}),F=function(e){var t=e.canvasOffsetTop,r=e.scrollY,n=e.heightMargin,a=e.scale,i=e.height;return function(e){return-(e.clientY-t+r)/a+n+i/2}}({canvasOffsetTop:m.offsetTop,scrollY:window.scrollY,height:te.size.height,heightMargin:te.size.heightMargin,scale:k}),L=function(e,t){return e>te.size.width/2+te.size.widthMargin||e<-te.size.width/2-te.size.widthMargin||t>te.size.height/2+te.size.heightMargin||t<-te.size.height/2-te.size.heightMargin};N=function(e){if("changedTouches"in e){P=!1;for(var t=0;t<e.changedTouches.length;t++){var r=e.changedTouches[t],n=I({clientX:r.screenX}),a=F({clientY:r.screenY});L(n,a)||(P=!0,ue(n,a,r.identifier))}}else{var i=I(e),o=F(e);L(i,o)?P=!1:(P=!0,ue(i,o,e.pointerId))}},D=function(e){if("changedTouches"in e)for(var t=0;t<e.changedTouches.length;t++){var r=e.changedTouches[t],n=I({clientX:r.screenX}),a=F({clientY:r.screenY});L(n,a)||se(n,a)}else{var i=I(e),o=F(e);L(i,o)||se(i,o)}},j=function(e){if("changedTouches"in e)for(var t=0;t<e.changedTouches.length;t++){var r=e.changedTouches[t],n=I({clientX:r.screenX}),a=F({clientY:r.screenY});L(n,a)?ce(r.identifier):le(n,a,r.identifier)}else{var i=I(e),o=F(e);L(i,o)?ce(e.pointerId):le(i,o,e.pointerId)}},z=function(e){if("changedTouches"in e)for(var t=0;t<e.changedTouches.length;t++)ce(e.changedTouches[t].identifier);else ce(e.pointerId)},document.addEventListener(g,N,!1),document.addEventListener(y,D,!1),document.addEventListener(x,j,!1),document.addEventListener(b,z,!1),U=te.size}}window.addEventListener("scroll",G,!1),document.addEventListener("contextmenu",(function(e){e.preventDefault()}));var J={},K={},q=function(e,t){return function(){throw Error("Failed to load "+e+' file "'+t+'"')}},Q=(null==r?void 0:r.fileFetch)||fetch,Z={audioElements:J,imageElements:K,loadAudioFile:function(e){return function(e,t){return ve.apply(this,arguments)}(R,Q(e)).then((function(e){return{buffer:e,volume:1}})).catch(q("audio",e))},loadImageFile:function(e,t){return new Promise((function(r,n){var a=new Image;a.addEventListener("load",(function(){r(function(e,t,r){var n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),r?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST)):e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR);var a={texture:n,image:t};return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),a}(_,a,t))})),a.addEventListener("error",n),a.src=e})).catch(q("image",e))},cleanupAudioFile:function(e){var t=J[e].data;!("then"in t)&&t.playState&&(t.playState.sample.onended=null,t.playState.sample.disconnect(),t.playState.sample.buffer=null)},cleanupImageFile:function(e){var t=K[e].data;"then"in t||_.deleteTexture(t.texture)}},$={newFrame:function(){return null},endFrame:function(){return null},startRenderSprite:function(){return null},endRenderSprite:function(){return null},renderTexture:function(){return null},startNativeSprite:function(){return null},endNativeSprite:function(){return null},getInitTextureState:function(){return null},getInitMaskState:function(){return{value:null}}},ee={resolution:1,hasSet:!1,get:function(){return this.resolution},set:function(e){this.resolution=e,this.hasSet=!0,X(),te.storage.setItem(xe,String(e))}},te=function(e,t,r,n,a){return Object.assign({isTouchScreen:Ae(),log:console.log,random:Math.random,timer:fe(),audio:me(e,r.audioElements),assetUtils:r,network:ge(),storage:ye(),alert:{ok:function(e,t){alert(e),null==t||t()},okCancel:function(e,t){t(confirm(e))}},clipboard:be(),size:t,now:function(){return new Date},resolution:a},n)}(R,pe((null==l?void 0:l.width)||window.innerWidth,(null==l?void 0:l.height)||window.innerHeight,i,e.props.size),Z,(null==r?void 0:r.device)||{},ee);te.storage.getItem(xe).then((function(e){if(null!==e){var t=Number(e);isNaN(t)||ee.set(t)}}));var re={mutDevice:te,getInputs:ne,newInputs:ae,render:$,isTestPlatform:!1},he={isLastFrame:!0,didResize:!1,scale:1,gameXToPlatformX:function(e){return e},gameYToPlatformY:function(e){return e},size:te.size},_e=!1,we=function e(){document.removeEventListener("keydown",e,!1),document.removeEventListener(g,e,!1),"suspended"===R.state&&R.resume(),R.onstatechange=function(){"suspended"!==R.state||document.hidden||R.resume()}};return document.addEventListener("keydown",we,!1),document.addEventListener(g,we,!1),function t(){var r=(null==l?void 0:l.width)||window.innerWidth,n=(null==l?void 0:l.height)||window.innerHeight;if(r&&n){X();var a=function(e,t,r,n){var a=e.mutDevice,i=e.getInputs,o=e.newInputs,u=e.isTestPlatform,s={index:0,stack:[{opacity:1,transformation:F.getScaleMatrix(2/a.size.fullWidth,2/a.size.fullHeight),transformationGameCoords:[].concat(F.identityMatrix),hasMask:!1}]},l=[0,0,0,0,0,0],c=[0,0,0,0,0,0],d={addToStack:function(e){var t=s.stack[s.index];B(t.transformation,l,e),B(t.transformationGameCoords,c,e),s.index++;var r=s.stack[s.index];if(r){r.opacity=t.opacity*e.opacity,r.hasMask=null!==e.mask;for(var n=0;n<l.length;n++)r.transformation[n]=l[n];for(var a=0;a<c.length;a++)r.transformationGameCoords[a]=c[a];return r}var i=[].concat(l),o=[].concat(c),u={opacity:t.opacity*e.opacity,hasMask:null!==e.mask,transformation:i,transformationGameCoords:o};return s.stack.push(u),u},removeFromStack:function(){var e=s.stack[s.index];return s.index--,e},getStack:function(e){return s.stack[e]},getStackIndex:function(){return s.index},getTopStack:function(){return s.stack[s.index]}},p=W(r,a,i,o,d,0,r.props.id,[]),f=n||r.props.size,v=H(a.size,f),m=0,h=0,g={isEmpty:!1,newFrame:e.render.newFrame,endFrame:e.render.endFrame,startRenderSprite:e.render.startRenderSprite,endRenderSprite:e.render.endRenderSprite,renderTexture:e.render.renderTexture,startNativeSprite:e.render.startNativeSprite,endNativeSprite:e.render.endNativeSprite,getInitTextureState:e.render.getInitTextureState,getInitMaskState:e.render.getInitMaskState};g.newFrame(),Y(p,r.props,a,d,i,o,!0,v,0,r.props.id,t,g,u,[]),g.endFrame();var y=function(){return null},x=function(){return null},b=function(){return null},A=function(){return null},_=function(){return null},w=function(){return null},E=function(){return null};return e.render.getInitTextureState,e.render.getInitMaskState,{runNextFrame:function(n,l){var c=n-m;m=n,h+=c;var v=Math.floor(h/V);for(t.nativeSpriteUtils.didResize&&(s.stack[0].transformation=F.getScaleMatrix(2/a.size.fullWidth,2/a.size.fullHeight));v>0;){v--;var S=(h-=V)/V,T=H(a.size,f),R=0===v;R&&g.isEmpty?(g.isEmpty=!1,g.newFrame=e.render.newFrame,g.endFrame=e.render.endFrame,g.startRenderSprite=e.render.startRenderSprite,g.endRenderSprite=e.render.endRenderSprite,g.renderTexture=e.render.renderTexture,g.startNativeSprite=e.render.startNativeSprite,g.endNativeSprite=e.render.endNativeSprite):R||g.isEmpty||(g.isEmpty=!0,g.newFrame=y,g.endFrame=x,g.startRenderSprite=b,g.endRenderSprite=A,g.renderTexture=_,g.startNativeSprite=w,g.endNativeSprite=E),t.nativeSpriteUtils.isLastFrame=R,g.newFrame(),Y(p,r.props,a,d,i,o,!1,T,S,r.props.id,t,g,u,[]),g.endFrame(),t.nativeSpriteUtils.didResize=!1,l()}}}}(re,{nativeSpriteMap:s,nativeSpriteUtils:he},e).runNextFrame,i=null;o()}else setTimeout(t,50);function o(){null==d||d(),window.requestAnimationFrame(u)}function u(e){_e||(null==c||c(),null===i&&(i=e-1/60),k?(L&&(L=!1,M+=e-O),I=e,a(e-i-M,de),o()):o())}}(),{cleanup:function(){m.width=m.width,o||document.body.removeChild(m),_e=!0,document.removeEventListener("keydown",ie,!1),document.removeEventListener("keyup",oe,!1),document.removeEventListener("visibilitychange",C,!1),window.removeEventListener("resize",X,!1),window.removeEventListener("scroll",G,!1),X({cleanup:!0})},audioElements:J,imageElements:K,audioContext:R}}function Ye(e){var t=e.Game,r=e.gameProps,i=e.showReload,o=function(){var e=Object(n.useRef)(null),t=Object(n.useState)(null),r=t[0],a=t[1],i=function(){a(e.current.getBoundingClientRect())};Object(n.useEffect)((function(){return window.addEventListener("resize",i,!1),function(){return window.removeEventListener("resize",i,!1)}}),[]);var o=Object(n.useCallback)((function(t){null!==t&&(e.current=t,i())}),[]);return Object(n.useEffect)((function(){document.getElementById("iphone-img").onload=function(){i()}}),[]),[r,o]}(),u=o[0],s=o[1],l=Object(n.useState)(0),c=l[0],d=l[1],p=0,f=0,v=0;if(u&&u.height&&u.width){var m=375/667;u.width/u.height>m?(f=u.height*(667/900),p=f*m):(p=u.width*(375/460),f=p/m);var g=r.size.maxHeightMargin?0:.08*f;v=(u.height-f)/2+g}return Object(n.useEffect)((function(){if(p&&f){var e=document.getElementById("myCanvas"),n=ze(t(r),{dimensions:"scale-up",canvas:e,windowSize:{width:p,height:f}}).cleanup;return function(){n()}}}),[p,f,c]),a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{ref:s,style:{height:"100%",width:"100%",display:"flex",justifyContent:"center"}},a.a.createElement("img",{id:"iphone-img",style:{userSelect:"none",objectFit:"contain",maxHeight:"100%"},src:"/img/iPhone8-Portrait-SpaceGray.png"})),i&&a.a.createElement("img",{className:h.a.refresh,src:"/img/reload.svg",width:20,height:20,onClick:function(){return d((function(e){return e+1}))}}),a.a.createElement("canvas",{id:"myCanvas",style:{position:"absolute",marginTop:v},width:p,height:f}))}function Ge(e){var t=e.part,r=e.MDXContent,n=e.codesTs,s=e.codesJs,l=e.Game,c=e.gameProps,d=e.image,p=e.isEnd,f=n&&s,v=l&&c?a.a.createElement(u.a,{fallback:a.a.createElement("div",null,"Preview")},(function(){return a.a.createElement(Ye,{Game:l,gameProps:c,showReload:f})})):a.a.createElement("div",null,a.a.createElement("img",{src:d}));return a.a.createElement(i.a,{title:"Tutorial - Part "+t,noFooter:!0},a.a.createElement("div",{style:{display:"flex",minWidth:1024,height:"calc(100vh - 60px)"}},a.a.createElement("div",{style:{flex:"1",overflow:"auto",padding:16,borderRight:"1px solid #ededed"}},a.a.createElement(r,null),a.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},t>1?a.a.createElement(o.a,{to:"/tutorial/"+(t-1)},"Back"):a.a.createElement("div",null),p?a.a.createElement("div",null):a.a.createElement(o.a,{to:"/tutorial/"+(t+1)},"Next"))),f?a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{style:{flex:"1",overflow:"auto",borderRight:"1px solid #ededed"}},a.a.createElement(g,{codesTs:n,codesJs:s})),a.a.createElement("div",{style:{flex:"1",display:"flex",justifyContent:"center"}},v)):a.a.createElement("div",{style:{flex:"2",display:"flex",justifyContent:"center"}},v)))}},183:function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return h}));var n=r(160),a=r(165),i=50,o=40,u=Object(n.a)({render:function(){return[n.b.image({testId:"bird",fileName:"/img/bird.png",width:i,height:o})]}}),s=40,l=Object(n.a)({render:function(e){var t=e.props,r=c(e.device.size,t.pipe.gapY),a=r.yUpperTop,i=r.yUpperBottom,o=r.yLowerTop,u=r.yLowerBottom;return[n.b.rectangle({color:"green",width:s,height:a-i,y:(a+i)/2}),n.b.rectangle({color:"green",width:s,height:o-u,y:(o+u)/2})]}});function c(e,t){return{yUpperTop:e.height/2+e.heightMargin,yUpperBottom:t+85,yLowerTop:t-85,yLowerBottom:-e.height/2-e.heightMargin}}var d=Object(n.a)({init:function(e){var t=e.device;return{birdY:10,birdGravity:-12,pipes:e.props.paused?[]:[p(t)],score:0}},loop:function(e){var t=e.props,r=e.state,n=e.getInputs,i=e.device;if(t.paused)return r;var o=n(),u=r.birdGravity,l=r.birdY,d=r.pipes,v=r.score;return l-=u+=.8,(o.pointer.justPressed||o.keysJustPressed[" "])&&(u=-12),d[d.length-1].x<140&&(d=[].concat(d,[p(i)]).filter((function(e){return e.x>-(i.size.width+i.size.widthMargin+s)}))),function(e,t,r){if(e-20<-(t.height/2+t.heightMargin)||e+20>t.height/2+t.heightMargin)return!0;for(var n,i=function(){var r=n.value;if(r.x>45||r.x<-45)return"continue";var a=c(t,r.gapY),i=a.yUpperTop,o=a.yUpperBottom,u=a.yLowerTop,l=a.yLowerBottom,d={x:r.x,y:(i+o)/2,width:s,height:i-o},p={x:r.x,y:(u+l)/2,width:s,height:u-l};return[{x:25,y:e+20},{x:25,y:e-20},{x:0,y:e+20},{x:0,y:e-20},{x:-25,y:e+20},{x:-25,y:e-20}].some((function(e){return f(e,d)||f(e,p)}))?{v:!0}:void 0},o=Object(a.a)(r);!(n=o()).done;){var u=i();if("continue"!==u&&"object"==typeof u)return u.v}return!1}(l,i.size,d)&&(i.audio("/audio/boop.wav").play(),t.gameOver(r.score)),{birdGravity:u,birdY:l,pipes:d=d.map((function(e){var t=e.passed;return!t&&e.x<-45&&(t=!0,v++),Object.assign({},e,{passed:t,x:e.x-2})})),score:v}},render:function(e){var t=e.state,r=e.device,a=r.size;return[n.b.rectangle({color:"#add8e6",width:a.width+2*a.widthMargin,height:a.height+2*a.heightMargin}),u({id:"bird",x:0,y:t.birdY,rotation:Math.max(-30,3*t.birdGravity-30)})].concat(t.pipes.map((function(e,t){return l({id:"pipe-"+t,pipe:e,x:e.x})})),[n.b.text({text:"Score: "+t.score,color:"white",x:-r.size.width/2+10,y:r.size.height/2+r.size.heightMargin-80,font:{align:"left"}})])}});function p(e){var t=(e.size.height+2*e.size.heightMargin-340)*(e.random()-.5);return{x:e.size.width+e.size.widthMargin+50,gapY:t,passed:!1}}function f(e,t){return e.x>t.x-t.width/2&&e.x<t.x+t.width/2&&e.y>t.y-t.height/2&&e.y<t.y+t.height/2}var v=Object(n.a)({render:function(e){var t=e.props,r=e.getInputs,a=e.device,i=r();return(i.pointer.justReleased||i.keysJustPressed[" "])&&t.start(),[n.b.text({text:a.isTouchScreen?"Tap to Start":"Click or Space Bar to Start",color:"white",y:100}),n.b.text({text:"High score: "+t.highScore,font:{family:"Courier",size:24},color:"white",y:150})]}}),m=Object(n.a)({init:function(e){var t=e.device,r=e.preloadFiles,n=e.updateState;return Promise.all([t.storage.getItem("highScore"),r({imageFileNames:["/img/bird.png"],audioFileNames:["/audio/boop.wav"]})]).then((function(e){var t=e[0];n((function(e){return Object.assign({},e,{view:"menu",highScore:Number(t||"0")})}))})),{view:"loading",attempt:0,highScore:0}},render:function(e){var t=e.state,r=e.updateState,a=e.device;if("loading"===t.view)return[n.b.text({color:"black",text:"Loading..."})];var i="menu"===t.view;return[d({id:"level-"+t.attempt,paused:i,gameOver:function(e){r((function(t){var r=t.highScore;return e>r&&(r=e,a.storage.setItem("highScore",String(r))),Object.assign({},t,{view:"menu",highScore:r})}))}}),i?v({id:"menu",highScore:t.highScore,start:function(){r((function(e){return Object.assign({},e,{view:"level",attempt:e.attempt+1})}))}}):null]}}),h={id:"Game",size:{width:400,height:600,maxHeightMargin:150},defaultFont:{family:"Helvetica",size:24}}},60:function(e,t,r){"use strict";r.r(t),r.d(t,"frontMatter",(function(){return o})),r.d(t,"metadata",(function(){return u})),r.d(t,"toc",(function(){return s})),r.d(t,"default",(function(){return c}));var n=r(3),a=r(7),i=(r(0),r(159)),o={},u={unversionedId:"tutorial/23",id:"tutorial/23",isDocsHomePage:!1,title:"23",description:"23 - The End",source:"@site/docs/tutorial/23.md",slug:"/tutorial/23",permalink:"/docs/tutorial/23",editUrl:"https://github.com/edbentley/replay/edit/master/website/docs/tutorial/23.md",version:"current"},s=[],l={toc:s};function c(e){var t=e.components,r=Object(a.a)(e,["components"]);return Object(i.b)("wrapper",Object(n.a)({},l,r,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h1",{id:"23---the-end"},"23 - The End"),Object(i.b)("p",null,"That's it! Congratulations on making it to the end. From Sprites to storage, we've covered most of the building blocks you need to build your own game using Replay."),Object(i.b)("p",null,"You can see the full source code for Replay Bird ",Object(i.b)("a",{parentName:"p",href:"https://github.com/edbentley/replay-bird"},"on GitHub"),"."),Object(i.b)("p",null,"For a more thorough reference, head over to the ",Object(i.b)("a",{parentName:"p",href:"/docs/sprites"},"API docs"),". Good luck!"))}c.isMDXComponent=!0}}]);