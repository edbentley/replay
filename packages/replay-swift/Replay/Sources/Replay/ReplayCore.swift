// Swift 5.3 will support Package resources like a JS file
// https://github.com/apple/swift-evolution/blob/master/proposals/0271-package-manager-resources.md
// Until then, we'll just copy replay-core.js as a string here

let replayCoreJsString = """
var replay=function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";function n(t,e,r,n){const s=r||game.Game(game.gameProps),p=({x:t,y:e})=>({x:t,y:e}),c=t.getGetDevice(),u=c(p),l=o(s,c(p),0),d=n||s.props.size,h=a(u.size,d);return{initTextures:i(l,s.props,c,p,!0,h,0,1,s.props.id,e),getNextFrameTextures(r){const n=t.getGetDevice(),o=a(n(p).size,d);return i(l,s.props,n,p,!1,o,r,1,s.props.id,e)}}}function i(t,e,r,n,a,c,u,l,d,h){const f={x:(y=e).x||0,y:y.y||0,rotation:y.rotation||0,opacity:Math.min(1,Math.max(0,null!==(v=y.opacity)&&void 0!==v?v:1)),scaleX:null!==(m=y.scaleX)&&void 0!==m?m:1,scaleY:null!==(g=y.scaleY)&&void 0!==g?g:1,anchorX:y.anchorX||0,anchorY:y.anchorY||0};var y,v,m,g;f.opacity*=l;const{nativeSpriteMap:x,nativeSpriteUtils:b}=h,S=t=>{const e=n(t);return p(f)(e)},L=r(S),X=t.getSprites(e,L,a,c,u),M=[],P=X.map(e=>{if(!e)return e;if("native"===e.type){M.push(e.props.id);const r=x[e.name];if(!r)throw Error(`Cannot find Native Sprite "${e.name}"`);let n=t.childContainers[e.props.id];return n&&"native"===n.type||(n={type:"native",state:r.create({props:e.props,parentGlobalId:d,getState:()=>n.state,updateState:t=>{n.state={...n.state,...t}},utils:b}),cleanup:r.cleanup},t.childContainers[e.props.id]=n),n.state=r.loop({props:e.props,state:n.state,parentGlobalId:d,utils:b}),b.didResize=!1,null}if("custom"===e.type){M.push(e.props.id);let n=!1,a=t.childContainers[e.props.id];return a&&"custom"===a.type||(n=!0,a=o(e,L,t.prevTime),t.childContainers[e.props.id]=a),i(a,e.props,r,S,n,c,u,f.opacity,`${d}--${e.props.id}`,h)}return e}).filter(s),C=t=>{Object.keys(t).forEach(e=>{if(!M.includes(e)){const r=t[e];"native"===r.type?r.cleanup({state:r.state,parentGlobalId:d}):C(r.childContainers),delete t[e]}})};return C(t.childContainers),{id:e.id,baseProps:f,textures:P}}r.r(e),r.d(e,"replayCore",(function(){return n})),r.d(e,"getLocalCoordsForSprite",(function(){return p}));function o(t,e,r){const{spriteObj:n,props:i}=t,o=[],a=t=>{o.push(t)};let s;return n.init&&(s=n.init({props:i,device:e,updateState:a})),{type:"custom",state:s,childContainers:{},prevTime:r,currentLag:0,getSprites(t,e,r,i,s){const p=s-this.prevTime;this.prevTime=s,this.currentLag+=p;let c=0;const u=()=>{this.state=o.reduce((t,e)=>e(t),this.state),o.length=0};if(u(),!r&&n.loop){for(;this.currentLag>=1/60*1e3;)this.state=n.loop({props:t,state:this.state,device:e,updateState:a}),this.currentLag-=1/60*1e3;c=this.currentLag/(1/60*1e3)}u();let l=n[i];l||(l="renderPXL"===i&&n.renderXL?n.renderXL:n.render);const d=l({props:t,state:this.state,device:e,updateState:a,extrapolateFactor:c});return u(),d}}}function a(t,e){const r=t.deviceHeight>t.deviceWidth;let n,i=!1;return"portrait"in e?(n=r?e.portrait:e.landscape,i=!0):n=e,n.minHeightXL&&t.deviceHeight>=n.minHeightXL||n.minWidthXL&&t.deviceWidth>=n.minWidthXL?i&&r?"renderPXL":"renderXL":i&&r?"renderP":"render"}function s(t){return null!==t}function p(t){const e=t.x,r=t.y,n=Math.PI/180,i=-(t.rotation||0)*n;return({x:n,y:o})=>{const a=(n-e)*Math.cos(i)+(o-r)*Math.sin(i),s=-(n-e)*Math.sin(i)+(o-r)*Math.cos(i),p=t.x+(a-t.x)/t.scaleX,c=t.y+(s-t.y)/t.scaleY;return{x:p+t.anchorX,y:c+t.anchorY}}}}]);
"""
